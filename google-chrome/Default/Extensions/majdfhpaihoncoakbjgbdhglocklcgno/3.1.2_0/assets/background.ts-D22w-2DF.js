var Lr=Object.defineProperty;var Ur=(t,e,s)=>e in t?Lr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var me=(t,e,s)=>Ur(t,typeof e!="symbol"?e+"":e,s);import{j as Hr,b as B,m as _t,k as Z,l as Ye,n as Se,o as fe,p as ve,q as G,r as Ks,s as Ws,t as xe,w as Gs,z as F,x as re,y as kt,u as Dt,A as Tt,v as Vs,B as Bt,C as et,E as Pe,F as zr,G as It,H as Qs,I as qr,J as jr,K as Kr,M as Wr,N as Gr,O as Vr}from"./index-CdhQCIyy.js";class Qr{constructor(e,s,r,n,i,o,a,c,u,d){this.analyticsService=e,this.accessService=s,this.appService=r,this.notificationService=n,this.i18nService=i,this.globalStateService=o,this.apiFreeService=a,this.apiPremiumService=c,this.userService=u,this.webrtcService=d}async sendAnalyticEvent(e){return await Promise.resolve(),this.analyticsService.sendEvent(e),{success:!0,data:{success:!0}}}async showWebsitePage(e){return await this.accessService.proceedToWebsitePage(e),{success:!0,data:{success:!0}}}async setColorTheme(e){return await this.appService.setColorTheme(e),{success:!0,data:{success:!0}}}async getAppData(){return await Promise.resolve(),{success:!0,data:{version:this.appService.version,theme:this.appService.colorTheme,isOnline:this.globalStateService.hasInternetConnection}}}async getShowOnboarding(){return await Promise.resolve(),{success:!0,data:{show:this.appService.showOnboarding}}}async closeOnboarding(){return await this.appService.setShowOnboarding(!1),{success:!0,data:{success:!0}}}async setActiveLocale(e){return await this.i18nService.setLocale(e),{success:!0,data:{success:!0}}}async getActiveLocale(){return await Promise.resolve(),{success:!0,data:{locale:this.i18nService.activeLocale}}}async getLanguageList(){return await Promise.resolve(),{success:!0,data:{list:this.i18nService.languageList}}}async getNotificationPermition(){return await Promise.resolve(),{success:!0,data:{permition:this.notificationService.permition}}}async setNotificationPermition(e){return await this.notificationService.setNotificationPermition(e),{success:!0,data:{success:!0}}}async getSessionCount(){return await Promise.resolve(),{success:!0,data:{count:this.appService.sessionCount}}}async incrementSessionCount(){return await this.appService.incrementSessionCount(),{success:!0,data:{success:!0}}}async getPremiumBanner(){return await Promise.resolve(),{success:!0,data:{timestamp:this.appService.premiumBannerTimestamp}}}async incrementPremiumBanner(){return await this.appService.incrementPremiumBannerTimestamp(),{success:!0,data:{success:!0}}}async getDownloadLink(e){return{success:!0,data:{link:await this.appService.getDownloadLink(e)}}}async getBlockAds(){return await Promise.resolve(),{success:!0,data:{status:this.appService.isBlockAds}}}async setBlockAds(e){return await this.appService.setBlockAds(e.status),{success:!0,data:{success:!0}}}async setDeviceScreenData(e){return await this.globalStateService.setDeviceScreenData(e),{success:!0,data:{success:!0}}}async getRateUsData(){return await Promise.resolve(),{success:!0,data:this.appService.rateUsData}}async incrementRateUsData(){return await this.appService.incrementRateUs(),{success:!0,data:{success:!0}}}async showExtensionStore(){const e={platform:Hr()},s=this.userService.canUsePremiumDomain?await this.apiPremiumService.fetch({method:"POST",url:"apiUrlReview",body:e}):await this.apiFreeService.fetch({method:"POST",url:"apiUrlReview",body:e}),r=s.success?s.data.url:this.appService.extensionStoreUrl;return await B.tabs.create({url:r}),{success:!0,data:{success:!0}}}async getBlockWebrtc(){return await Promise.resolve(),{success:!0,data:{status:this.webrtcService.isApplied}}}async enableBlockWebrtc(){const e=await this.webrtcService.enable();return e.status?(await this.webrtcService.setBlockWebrtc(!0),{success:!0,data:{success:!0}}):{success:!1,errors:[{code:0,status:0,name:"",message:e.cause==="not_controllable"?this.i18nService.t("base:webrtc-errors.not-controllable"):this.i18nService.t("base:webrtc-errors.controlled-by-other-extensions")}]}}async disableBlockWebrtc(){return await this.webrtcService.disable()?(await this.webrtcService.setBlockWebrtc(!1),{success:!0,data:{success:!0}}):{success:!1,errors:[{code:0,status:0,name:"",message:this.i18nService.t("base:webrtc-errors.remove-webrtc")}]}}}class Xr{constructor(e,s){this.messageService=e,this.appController=s}init(){this.messageService.subscribe({"hold-active-ping":this.holdActivePing.bind(this),"send-analytic-event":this.sendAnalyticEvent.bind(this),"show-website-page":this.showWebsitePage.bind(this),"set-color-theme":this.setColorTheme.bind(this),"get-app-data":this.getAppData.bind(this),"get-show-onboarding":this.getShowOnboarding.bind(this),"close-onboarding":this.closeOnboarding.bind(this),"set-active-locale":this.setActiveLocale.bind(this),"get-active-locale":this.getActiveLocale.bind(this),"get-language-list":this.getLanguageList.bind(this),"set-notification-permition":this.setNotificationPermition.bind(this),"get-notification-permition":this.getNotificationPermition.bind(this),"get-session-count":this.getSessionCount.bind(this),"increment-session-count":this.incrementSessionCount.bind(this),"get-premium-banner":this.getPremiumBanner.bind(this),"increment-premium-banner":this.incrementPremiumBanner.bind(this),"get-download-link":this.getDownloadLink.bind(this),"get-block-ads":this.getBlockAds.bind(this),"set-block-ads":this.setBlockAds.bind(this),"set-device-screen":this.setDeviceScreenData.bind(this),"get-rate-us":this.getRateUsData.bind(this),"increment-rate-us":this.incrementRateUsData.bind(this),"show-extension-store":this.showExtensionStore.bind(this),"get-block-webrtc":this.getBlockWebrtc.bind(this),"enable-block-webrtc":this.enableBlockWebrtc.bind(this),"disable-block-webrtc":this.disableBlockWebrtc.bind(this)})}async holdActivePing(){return await Promise.resolve(this),{type:"hold-active-ping",success:!0,data:{success:!0}}}async sendAnalyticEvent(e){return{...await this.appController.sendAnalyticEvent(e),type:"send-analytic-event"}}async showWebsitePage(e){return{...await this.appController.showWebsitePage(e),type:"show-website-page"}}async setColorTheme(e){return{...await this.appController.setColorTheme(e),type:"set-color-theme"}}async getAppData(){return{...await this.appController.getAppData(),type:"get-app-data"}}async getShowOnboarding(){return{...await this.appController.getShowOnboarding(),type:"get-show-onboarding"}}async closeOnboarding(){return{...await this.appController.closeOnboarding(),type:"close-onboarding"}}async setActiveLocale(e){return{...await this.appController.setActiveLocale(e),type:"set-active-locale"}}async getActiveLocale(){return{...await this.appController.getActiveLocale(),type:"get-active-locale"}}async getLanguageList(){return{...await this.appController.getLanguageList(),type:"get-language-list"}}async setNotificationPermition(e){return{...await this.appController.setNotificationPermition(e),type:"set-notification-permition"}}async getNotificationPermition(){return{...await this.appController.getNotificationPermition(),type:"get-notification-permition"}}async getSessionCount(){return{...await this.appController.getSessionCount(),type:"get-session-count"}}async incrementSessionCount(){return{...await this.appController.incrementSessionCount(),type:"increment-session-count"}}async getPremiumBanner(){return{...await this.appController.getPremiumBanner(),type:"get-premium-banner"}}async incrementPremiumBanner(){return{...await this.appController.incrementPremiumBanner(),type:"increment-premium-banner"}}async getDownloadLink(e){return{...await this.appController.getDownloadLink(e),type:"get-download-link"}}async getBlockAds(){return{...await this.appController.getBlockAds(),type:"get-block-ads"}}async setBlockAds(e){return{...await this.appController.setBlockAds(e),type:"set-block-ads"}}async setDeviceScreenData(e){return{...await this.appController.setDeviceScreenData(e),type:"set-device-screen"}}async getRateUsData(){return{...await this.appController.getRateUsData(),type:"get-rate-us"}}async incrementRateUsData(){return{...await this.appController.incrementRateUsData(),type:"increment-rate-us"}}async showExtensionStore(){return{...await this.appController.showExtensionStore(),type:"show-extension-store"}}async getBlockWebrtc(){return{...await this.appController.getBlockWebrtc(),type:"get-block-webrtc"}}async enableBlockWebrtc(){return{...await this.appController.enableBlockWebrtc(),type:"enable-block-webrtc"}}async disableBlockWebrtc(){return{...await this.appController.disableBlockWebrtc(),type:"disable-block-webrtc"}}}const Jr=new Qr(Z,Ye,Se,fe,ve,G,Ks,Ws,xe,Gs),Zr=new Xr(_t,Jr),Yr=F.object({sessionId:F.string().optional().describe(re.session)}).default({}),en=new kt(Yr),tn="https://www.google-analytics.com/mp/collect",sn="G-JY9WLXGNHW",rn="cECyLU2hSiaL1TVJULha8Q",Oe=Dt.UAParser();class nn extends Tt{constructor(s,r,n,i,o,a,c,u,d,l){super(s);me(this,"GA_URL");this.analyticsStorage=r,this.analyticsService=n,this.globalStateService=i,this.fetchService=o,this.userService=a,this.appService=c,this.notificationService=u,this.i18nService=d,this.connectionService=l;const h=new URL(tn);h.searchParams.set("measurement_id",sn),h.searchParams.set("api_secret",rn),this.GA_URL=h.href,this.analyticsService.use(this)}async boot(){await this.analyticsStorage.sync(),this.analyticsStorage.state.sessionId||await this.updateSessionId(),this.bootResolve()}async send(s){if(await this.bootPromise,!this.available)return;const r=this.formatData(s);await this.fetchService.request({url:this.GA_URL,method:"POST",body:r})}formatData(s){var o;const r=this.globalStateService.udid.value,n=this.getUserProperties(),i={name:s.name,params:{session_id:this.analyticsStorage.state.sessionId??"",screen_name:"main",engagement_time_msec:100,runtime_last_error:((o=B.runtime.lastError)==null?void 0:o.message)??"not_set",...s.data??{}}};return{client_id:r,user_properties:n,events:[i]}}getUserProperties(){var u,d;const s=B.runtime.getManifest(),r=this.globalStateService.udid.value,n=((u=this.appService.geolocation)==null?void 0:u.country)??"n/a",i=((d=this.userService.subscription)==null?void 0:d.name)??"free",o=this.notificationService.permition==="allowed"?"on":"off",a=()=>this.appService.colorTheme==="dark"?"on":this.appService.colorTheme==="light"?"off":"default";return{user_type:{value:this.userService.userType},plan:{value:i},udid:{value:r},version:{value:s.version},platform:{value:"chrome_extension"},user_country:{value:n},desktop_notifications:{value:o},dark_mode:{value:a()},language:{value:this.i18nService.activeLocale},auto_connect:{value:this.connectionService.useAutoConnect},browser:{value:Oe.browser.name??"n/a"},browser_version:{value:Oe.browser.version??"n/a"},os:{value:Oe.os.name??"n/a"},os_version:{value:Oe.os.version??"n/a"}}}async updateSessionId(){const s=Vs();await this.analyticsStorage.setItems({sessionId:s})}}const on=new Bt("google-analytics",en),Y=new nn("google-analytics",on,Z,G,et,xe,Se,fe,ve,Pe),an="https://cloudflare.com/cdn-cgi/trace",cn=F.object({id:F.string(),startedAt:F.number()}),un=F.object({startAppVersion:F.string().optional().describe(re.persist),initialIpAddress:F.string().optional().describe(re.persist),sessionSequenceNumber:F.number().describe(re.persist),sessionData:cn.optional().describe(re.session),eventSequenceNumber:F.number().describe(re.persist)}).default({sessionSequenceNumber:0,eventSequenceNumber:0}),ln=new kt(un),dn="us-west-2",hn="29ac8a89-ab3a-4e4a-97c7-d594058fede6",pn="veepn-extension-kinesis",fn="AKIA5GXTSFOM3ZRUXRNC",mn="i8yxWsN0zHuGOJdiXLmqwZqytlh3LEFp+6AWLIxv",gn=t=>{let e=t.httpHandler;return{setHttpHandler(s){e=s},httpHandler(){return e},updateHttpClientConfig(s,r){e.updateHttpClientConfig(s,r)},httpHandlerConfigs(){return e.httpHandlerConfigs()}}},yn=t=>({httpHandler:t.httpHandler()});var ss;(function(t){t.HEADER="header",t.QUERY="query"})(ss||(ss={}));var rs;(function(t){t.HEADER="header",t.QUERY="query"})(rs||(rs={}));var Be;(function(t){t.HTTP="http",t.HTTPS="https"})(Be||(Be={}));var Ke;(function(t){t.MD5="md5",t.CRC32="crc32",t.CRC32C="crc32c",t.SHA1="sha1",t.SHA256="sha256"})(Ke||(Ke={}));var ns;(function(t){t[t.HEADER=0]="HEADER",t[t.TRAILER=1]="TRAILER"})(ns||(ns={}));const vt="__smithy_context";var is;(function(t){t.PROFILE="profile",t.SSO_SESSION="sso-session",t.SERVICES="services"})(is||(is={}));var os;(function(t){t.HTTP_0_9="http/0.9",t.HTTP_1_0="http/1.0",t.TDS_8_0="tds/8.0"})(os||(os={}));class q{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const s=new q({...e,headers:{...e.headers}});return s.query&&(s.query=wn(s.query)),s}static isInstance(e){if(!e)return!1;const s=e;return"method"in s&&"protocol"in s&&"hostname"in s&&"path"in s&&typeof s.query=="object"&&typeof s.headers=="object"}clone(){return q.clone(this)}}function wn(t){return Object.keys(t).reduce((e,s)=>{const r=t[s];return{...e,[s]:Array.isArray(r)?[...r]:r}},{})}class We{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const s=e;return typeof s.statusCode=="number"&&typeof s.headers=="object"}}const bn=t=>e=>async s=>{if(!q.isInstance(s.request))return e(s);const{request:r}=s,{handlerProtocol:n=""}=t.requestHandler.metadata||{};if(n.indexOf("h2")>=0&&!r.headers[":authority"])delete r.headers.host,r.headers[":authority"]=r.hostname+(r.port?":"+r.port:"");else if(!r.headers.host){let i=r.hostname;r.port!=null&&(i+=`:${r.port}`),r.headers.host=i}return e(s)},Sn={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},vn=t=>({applyToStack:e=>{e.add(bn(t),Sn)}}),xn=()=>(t,e)=>async s=>{var r,n;try{const i=await t(s),{clientName:o,commandName:a,logger:c,dynamoDbDocumentClientOptions:u={}}=e,{overrideInputFilterSensitiveLog:d,overrideOutputFilterSensitiveLog:l}=u,h=d??e.inputFilterSensitiveLog,f=l??e.outputFilterSensitiveLog,{$metadata:m,...w}=i.output;return(r=c==null?void 0:c.info)==null||r.call(c,{clientName:o,commandName:a,input:h(s.input),output:f(w),metadata:m}),i}catch(i){const{clientName:o,commandName:a,logger:c,dynamoDbDocumentClientOptions:u={}}=e,{overrideInputFilterSensitiveLog:d}=u,l=d??e.inputFilterSensitiveLog;throw(n=c==null?void 0:c.error)==null||n.call(c,{clientName:o,commandName:a,input:l(s.input),error:i,metadata:i.$metadata}),i}},En={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},An=t=>({applyToStack:e=>{e.add(xn(),En)}});var as={};const cs="X-Amzn-Trace-Id",Rn="AWS_LAMBDA_FUNCTION_NAME",Cn="_X_AMZN_TRACE_ID",_n=t=>e=>async s=>{const{request:r}=s;if(!q.isInstance(r)||t.runtime!=="node"||r.headers.hasOwnProperty(cs))return e(s);const n=as[Rn],i=as[Cn],o=a=>typeof a=="string"&&a.length>0;return o(n)&&o(i)&&(r.headers[cs]=i),e({...s,request:r})},kn={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},Dn=t=>({applyToStack:e=>{e.add(_n(t),kn)}});function Tn(t){return{...t,customUserAgent:typeof t.customUserAgent=="string"?[[t.customUserAgent]]:t.customUserAgent}}const Bn=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),Xs=t=>Bn.test(t)||t.startsWith("[")&&t.endsWith("]"),In=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),Mt=(t,e=!1)=>{if(!e)return In.test(t);const s=t.split(".");for(const r of s)if(!Mt(r))return!1;return!0},Ge={},Ie="endpoints";function oe(t){return typeof t!="object"||t==null?t:"ref"in t?`$${oe(t.ref)}`:"fn"in t?`${t.fn}(${(t.argv||[]).map(oe).join(", ")})`:JSON.stringify(t,null,2)}class j extends Error{constructor(e){super(e),this.name="EndpointError"}}const Mn=(t,e)=>t===e,Pn=t=>{const e=t.split("."),s=[];for(const r of e){const n=r.indexOf("[");if(n!==-1){if(r.indexOf("]")!==r.length-1)throw new j(`Path: '${t}' does not end with ']'`);const i=r.slice(n+1,-1);if(Number.isNaN(parseInt(i)))throw new j(`Invalid array index: '${i}' in path: '${t}'`);n!==0&&s.push(r.slice(0,n)),s.push(i)}else s.push(r)}return s},Js=(t,e)=>Pn(e).reduce((s,r)=>{if(typeof s!="object")throw new j(`Index '${r}' in '${e}' not found in '${JSON.stringify(t)}'`);return Array.isArray(s)?s[parseInt(r)]:s[r]},t),On=t=>t!=null,Fn=t=>!t,nt={[Be.HTTP]:80,[Be.HTTPS]:443},Nn=t=>{const e=(()=>{try{if(t instanceof URL)return t;if(typeof t=="object"&&"hostname"in t){const{hostname:h,port:f,protocol:m="",path:w="",query:g={}}=t,v=new URL(`${m}//${h}${f?`:${f}`:""}${w}`);return v.search=Object.entries(g).map(([_,I])=>`${_}=${I}`).join("&"),v}return new URL(t)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(t)} as a whatwg URL.`),null;const s=e.href,{host:r,hostname:n,pathname:i,protocol:o,search:a}=e;if(a)return null;const c=o.slice(0,-1);if(!Object.values(Be).includes(c))return null;const u=Xs(n),d=s.includes(`${r}:${nt[c]}`)||typeof t=="string"&&t.includes(`${r}:${nt[c]}`),l=`${r}${d?`:${nt[c]}`:""}`;return{scheme:c,authority:l,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:u}},$n=(t,e)=>t===e,Ln=(t,e,s,r)=>e>=s||t.length<s?null:r?t.substring(t.length-s,t.length-e):t.substring(e,s),Un=t=>encodeURIComponent(t).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Hn={booleanEquals:Mn,getAttr:Js,isSet:On,isValidHostLabel:Mt,not:Fn,parseURL:Nn,stringEquals:$n,substring:Ln,uriEncode:Un},Zs=(t,e)=>{const s=[],r={...e.endpointParams,...e.referenceRecord};let n=0;for(;n<t.length;){const i=t.indexOf("{",n);if(i===-1){s.push(t.slice(n));break}s.push(t.slice(n,i));const o=t.indexOf("}",i);if(o===-1){s.push(t.slice(i));break}t[i+1]==="{"&&t[o+1]==="}"&&(s.push(t.slice(i+1,o)),n=o+2);const a=t.substring(i+1,o);if(a.includes("#")){const[c,u]=a.split("#");s.push(Js(r[c],u))}else s.push(r[a]);n=o+1}return s.join("")},zn=({ref:t},e)=>({...e.endpointParams,...e.referenceRecord})[t],tt=(t,e,s)=>{if(typeof t=="string")return Zs(t,s);if(t.fn)return Ys(t,s);if(t.ref)return zn(t,s);throw new j(`'${e}': ${String(t)} is not a string, function or reference.`)},Ys=({fn:t,argv:e},s)=>{const r=e.map(i=>["boolean","number"].includes(typeof i)?i:tt(i,"arg",s)),n=t.split(".");return n[0]in Ge&&n[1]!=null?Ge[n[0]][n[1]](...r):Hn[t](...r)},qn=({assign:t,...e},s)=>{var n,i;if(t&&t in s.referenceRecord)throw new j(`'${t}' is already defined in Reference Record.`);const r=Ys(e,s);return(i=(n=s.logger)==null?void 0:n.debug)==null||i.call(n,`${Ie} evaluateCondition: ${oe(e)} = ${oe(r)}`),{result:r===""?!0:!!r,...t!=null&&{toAssign:{name:t,value:r}}}},Pt=(t=[],e)=>{var r,n;const s={};for(const i of t){const{result:o,toAssign:a}=qn(i,{...e,referenceRecord:{...e.referenceRecord,...s}});if(!o)return{result:o};a&&(s[a.name]=a.value,(n=(r=e.logger)==null?void 0:r.debug)==null||n.call(r,`${Ie} assign: ${a.name} := ${oe(a.value)}`))}return{result:!0,referenceRecord:s}},jn=(t,e)=>Object.entries(t).reduce((s,[r,n])=>({...s,[r]:n.map(i=>{const o=tt(i,"Header value entry",e);if(typeof o!="string")throw new j(`Header '${r}' value '${o}' is not a string`);return o})}),{}),er=(t,e)=>{if(Array.isArray(t))return t.map(s=>er(s,e));switch(typeof t){case"string":return Zs(t,e);case"object":if(t===null)throw new j(`Unexpected endpoint property: ${t}`);return tr(t,e);case"boolean":return t;default:throw new j(`Unexpected endpoint property type: ${typeof t}`)}},tr=(t,e)=>Object.entries(t).reduce((s,[r,n])=>({...s,[r]:er(n,e)}),{}),Kn=(t,e)=>{const s=tt(t,"Endpoint URL",e);if(typeof s=="string")try{return new URL(s)}catch(r){throw console.error(`Failed to construct URL with ${s}`,r),r}throw new j(`Endpoint URL must be a string, got ${typeof s}`)},Wn=(t,e)=>{var d,l;const{conditions:s,endpoint:r}=t,{result:n,referenceRecord:i}=Pt(s,e);if(!n)return;const o={...e,referenceRecord:{...e.referenceRecord,...i}},{url:a,properties:c,headers:u}=r;return(l=(d=e.logger)==null?void 0:d.debug)==null||l.call(d,`${Ie} Resolving endpoint from template: ${oe(r)}`),{...u!=null&&{headers:jn(u,o)},...c!=null&&{properties:tr(c,o)},url:Kn(a,o)}},Gn=(t,e)=>{const{conditions:s,error:r}=t,{result:n,referenceRecord:i}=Pt(s,e);if(n)throw new j(tt(r,"Error",{...e,referenceRecord:{...e.referenceRecord,...i}}))},Vn=(t,e)=>{const{conditions:s,rules:r}=t,{result:n,referenceRecord:i}=Pt(s,e);if(n)return sr(r,{...e,referenceRecord:{...e.referenceRecord,...i}})},sr=(t,e)=>{for(const s of t)if(s.type==="endpoint"){const r=Wn(s,e);if(r)return r}else if(s.type==="error")Gn(s,e);else if(s.type==="tree"){const r=Vn(s,e);if(r)return r}else throw new j(`Unknown endpoint rule: ${s}`);throw new j("Rules evaluation failed")},Qn=(t,e)=>{var u,d,l,h,f;const{endpointParams:s,logger:r}=e,{parameters:n,rules:i}=t;(d=(u=e.logger)==null?void 0:u.debug)==null||d.call(u,`${Ie} Initial EndpointParams: ${oe(s)}`);const o=Object.entries(n).filter(([,m])=>m.default!=null).map(([m,w])=>[m,w.default]);if(o.length>0)for(const[m,w]of o)s[m]=s[m]??w;const a=Object.entries(n).filter(([,m])=>m.required).map(([m])=>m);for(const m of a)if(s[m]==null)throw new j(`Missing required parameter: '${m}'`);const c=sr(i,{endpointParams:s,logger:r,referenceRecord:{}});if((l=e.endpointParams)!=null&&l.Endpoint)try{const m=new URL(e.endpointParams.Endpoint),{protocol:w,port:g}=m;c.url.protocol=w,c.url.port=g}catch{}return(f=(h=e.logger)==null?void 0:h.debug)==null||f.call(h,`${Ie} Resolved endpoint: ${oe(c)}`),c},rr=(t,e=!1)=>{if(e){for(const s of t.split("."))if(!rr(s))return!1;return!0}return!(!Mt(t)||t.length<3||t.length>63||t!==t.toLowerCase()||Xs(t))},us=":",Xn="/",Jn=t=>{const e=t.split(us);if(e.length<6)return null;const[s,r,n,i,o,...a]=e;if(s!=="arn"||r===""||n===""||a.join(us)==="")return null;const c=a.map(u=>u.split(Xn)).flat();return{partition:r,service:n,region:i,accountId:o,resourceId:c}},Zn=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{}}],Yn="1.1",ei={partitions:Zn,version:Yn};let ti=ei;const si=t=>{const{partitions:e}=ti;for(const r of e){const{regions:n,outputs:i}=r;for(const[o,a]of Object.entries(n))if(o===t)return{...i,...a}}for(const r of e){const{regionRegex:n,outputs:i}=r;if(new RegExp(n).test(t))return{...i}}const s=e.find(r=>r.id==="aws");if(!s)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...s.outputs}},nr={isVirtualHostableS3Bucket:rr,parseArn:Jn,partition:si};Ge.aws=nr;const ls="user-agent",it="x-amz-user-agent",ds=" ",ot="/",ri=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,ni=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,hs="-",ii=t=>(e,s)=>async r=>{var l,h;const{request:n}=r;if(!q.isInstance(n))return e(r);const{headers:i}=n,o=((l=s==null?void 0:s.userAgent)==null?void 0:l.map(at))||[],a=(await t.defaultUserAgentProvider()).map(at),c=((h=t==null?void 0:t.customUserAgent)==null?void 0:h.map(at))||[],u=[].concat([...a,...o,...c]).join(ds),d=[...a.filter(f=>f.startsWith("aws-sdk-")),...c].join(ds);return t.runtime!=="browser"?(d&&(i[it]=i[it]?`${i[ls]} ${d}`:d),i[ls]=u):i[it]=u,e({...r,request:n})},at=t=>{var o;const e=t[0].split(ot).map(a=>a.replace(ri,hs)).join(ot),s=(o=t[1])==null?void 0:o.replace(ni,hs),r=e.indexOf(ot),n=e.substring(0,r);let i=e.substring(r+1);return n==="api"&&(i=i.toLowerCase()),[n,i,s].filter(a=>a&&a.length>0).reduce((a,c,u)=>{switch(u){case 0:return c;case 1:return`${a}/${c}`;default:return`${a}#${c}`}},"")},oi={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},ai=t=>({applyToStack:e=>{e.add(ii(t),oi)}});var ps;(function(t){t.ENV="env",t.CONFIG="shared config entry"})(ps||(ps={}));const ci=!1,ui=!1,st=t=>t[vt]||(t[vt]={}),ie=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e},ir=t=>typeof t=="string"&&(t.startsWith("fips-")||t.endsWith("-fips")),fs=t=>ir(t)?["fips-aws-global","aws-fips"].includes(t)?"us-east-1":t.replace(/fips-(dkr-|prod-)?|-fips/,""):t,li=t=>{const{region:e,useFipsEndpoint:s}=t;if(!e)throw new Error("Region is missing");return{...t,region:async()=>{if(typeof e=="string")return fs(e);const r=await e();return fs(r)},useFipsEndpoint:async()=>{const r=typeof e=="string"?e:await e();return ir(r)?!0:typeof s!="function"?Promise.resolve(!!s):s()}}};function di(t){const e=new Map;for(const s of t)e.set(s.schemeId,s);return e}const hi=(t,e)=>(s,r)=>async n=>{var u;const i=t.httpAuthSchemeProvider(await e.httpAuthSchemeParametersProvider(t,r,n.input)),o=di(t.httpAuthSchemes),a=st(r),c=[];for(const d of i){const l=o.get(d.schemeId);if(!l){c.push(`HttpAuthScheme \`${d.schemeId}\` was not enabled for this service.`);continue}const h=l.identityProvider(await e.identityProviderConfigProvider(t));if(!h){c.push(`HttpAuthScheme \`${d.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:f={},signingProperties:m={}}=((u=d.propertiesExtractor)==null?void 0:u.call(d,t,r))||{};d.identityProperties=Object.assign(d.identityProperties||{},f),d.signingProperties=Object.assign(d.signingProperties||{},m),a.selectedHttpAuthScheme={httpAuthOption:d,identity:await h(d.identityProperties),signer:l.signer};break}if(!a.selectedHttpAuthScheme)throw new Error(c.join(`
`));return s(n)},pi=async t=>{const e=(t==null?void 0:t.Bucket)||"";if(typeof t.Bucket=="string"&&(t.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),wi(e)){if(t.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!yi(e)||e.indexOf(".")!==-1&&!String(t.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(t.ForcePathStyle=!0);return t.DisableMultiRegionAccessPoints&&(t.disableMultiRegionAccessPoints=!0,t.DisableMRAP=!0),t},fi=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,mi=/(\d+\.){3}\d+/,gi=/\.\./,yi=t=>fi.test(t)&&!mi.test(t)&&!gi.test(t),wi=t=>{const[e,s,r,,,n]=t.split(":"),i=e==="arn"&&t.split(":").length>=6,o=!!(i&&s&&r&&n);if(i&&!o)throw new Error(`Invalid ARN: ${t} was an invalid ARN.`);return o},bi=(t,e,s)=>{const r=async()=>{const n=s[t]??s[e];return typeof n=="function"?n():n};return t==="credentialScope"||e==="CredentialScope"?async()=>{const n=typeof s.credentials=="function"?await s.credentials():s.credentials;return(n==null?void 0:n.credentialScope)??(n==null?void 0:n.CredentialScope)}:t==="accountId"||e==="AccountId"?async()=>{const n=typeof s.credentials=="function"?await s.credentials():s.credentials;return(n==null?void 0:n.accountId)??(n==null?void 0:n.AccountId)}:t==="endpoint"||e==="endpoint"?async()=>{const n=await r();if(n&&typeof n=="object"){if("url"in n)return n.url.href;if("hostname"in n){const{protocol:i,hostname:o,port:a,path:c}=n;return`${i}//${o}${a?":"+a:""}${c}`}}return n}:r},Si=async t=>{};function vi(t){const e={};if(t=t.replace(/^\?/,""),t)for(const s of t.split("&")){let[r,n=null]=s.split("=");r=decodeURIComponent(r),n&&(n=decodeURIComponent(n)),r in e?Array.isArray(e[r])?e[r].push(n):e[r]=[e[r],n]:e[r]=n}return e}const Ve=t=>{if(typeof t=="string")return Ve(new URL(t));const{hostname:e,pathname:s,port:r,protocol:n,search:i}=t;let o;return i&&(o=vi(i)),{hostname:e,port:r?parseInt(r):void 0,protocol:n,path:s,query:o}},or=t=>typeof t=="object"?"url"in t?Ve(t.url):t:Ve(t),xi=async(t,e,s,r)=>{if(!s.endpoint){const o=await Si(s.serviceId||"");o&&(s.endpoint=()=>Promise.resolve(or(o)))}const n=await Ei(t,e,s);if(typeof s.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return s.endpointProvider(n,r)},Ei=async(t,e,s)=>{var i;const r={},n=((i=e==null?void 0:e.getEndpointParameterInstructions)==null?void 0:i.call(e))||{};for(const[o,a]of Object.entries(n))switch(a.type){case"staticContextParams":r[o]=a.value;break;case"contextParams":r[o]=t[a.name];break;case"clientContextParams":case"builtInParams":r[o]=await bi(a.name,o,s)();break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(a))}return Object.keys(n).length===0&&Object.assign(r,s),String(s.serviceId).toLowerCase()==="s3"&&await pi(r),r},Ai=({config:t,instructions:e})=>(s,r)=>async n=>{var a,c,u;const i=await xi(n.input,{getEndpointParameterInstructions(){return e}},{...t},r);r.endpointV2=i,r.authSchemes=(a=i.properties)==null?void 0:a.authSchemes;const o=(c=r.authSchemes)==null?void 0:c[0];if(o){r.signing_region=o.signingRegion,r.signing_service=o.signingName;const d=st(r),l=(u=d==null?void 0:d.selectedHttpAuthScheme)==null?void 0:u.httpAuthOption;l&&(l.signingProperties=Object.assign(l.signingProperties||{},{signing_region:o.signingRegion,signingRegion:o.signingRegion,signing_service:o.signingName,signingName:o.signingName,signingRegionSet:o.signingRegionSet},o.properties))}return s({...n})},Ri=(t,e)=>s=>async r=>{const{response:n}=await s(r);try{const i=await e(n,t);return{response:n,output:i}}catch(i){if(Object.defineProperty(i,"$response",{value:n}),!("$metadata"in i)){const o="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";i.message+=`
  `+o,typeof i.$responseBodyText<"u"&&i.$response&&(i.$response.body=i.$responseBodyText)}throw i}},Ci=(t,e)=>(s,r)=>async n=>{var a;const i=(a=r.endpointV2)!=null&&a.url&&t.urlParser?async()=>t.urlParser(r.endpointV2.url):t.endpoint;if(!i)throw new Error("No valid endpoint provider available.");const o=await e(n.input,{...t,endpoint:i});return s({...n,request:o})},_i={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},Ot={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function ki(t,e,s){return{applyToStack:r=>{r.add(Ri(t,s),_i),r.add(Ci(t,e),Ot)}}}const ar={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:Ot.name},Di=(t,e)=>({applyToStack:s=>{s.addRelativeTo(Ai({config:t,instructions:e}),ar)}}),Ti=t=>{const e=t.tls??!0,{endpoint:s}=t,r=s!=null?async()=>or(await ie(s)()):void 0;return{...t,endpoint:r,tls:e,isCustomEndpoint:!!s,useDualstackEndpoint:ie(t.useDualstackEndpoint??!1),useFipsEndpoint:ie(t.useFipsEndpoint??!1)}},Bi={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:ar.name},Ii=(t,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:s})=>({applyToStack:r=>{r.addRelativeTo(hi(t,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:s}),Bi)}});Ot.name;const Mi=t=>e=>{throw e},Pi=(t,e)=>{},Oi=t=>(e,s)=>async r=>{if(!q.isInstance(r.request))return e(r);const i=st(s).selectedHttpAuthScheme;if(!i)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:o={}},identity:a,signer:c}=i,u=await e({...r,request:await c.sign(r.request,a,o)}).catch((c.errorHandler||Mi)(o));return(c.successHandler||Pi)(u.response,o),u};var we;(function(t){t.STANDARD="standard",t.ADAPTIVE="adaptive"})(we||(we={}));const Qe=3,Fi=we.STANDARD,Ni=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],$i=["TimeoutError","RequestTimeout","RequestTimeoutException"],Li=[500,502,503,504],Ui=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],Hi=t=>{var e;return(e=t.$metadata)==null?void 0:e.clockSkewCorrected},cr=t=>{var e,s;return((e=t.$metadata)==null?void 0:e.httpStatusCode)===429||Ni.includes(t.name)||((s=t.$retryable)==null?void 0:s.throttling)==!0},ur=t=>{var e;return Hi(t)||$i.includes(t.name)||Ui.includes((t==null?void 0:t.code)||"")||Li.includes(((e=t.$metadata)==null?void 0:e.httpStatusCode)||0)},zi=t=>{var e;if(((e=t.$metadata)==null?void 0:e.httpStatusCode)!==void 0){const s=t.$metadata.httpStatusCode;return 500<=s&&s<=599&&!ur(t)}return!1};class qi{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=(e==null?void 0:e.beta)??.7,this.minCapacity=(e==null?void 0:e.minCapacity)??1,this.minFillRate=(e==null?void 0:e.minFillRate)??.5,this.scaleConstant=(e==null?void 0:e.scaleConstant)??.4,this.smooth=(e==null?void 0:e.smooth)??.8;const s=this.getCurrentTimeInSeconds();this.lastThrottleTime=s,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const s=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(r=>setTimeout(r,s))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const s=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+s),this.lastTimestamp=e}updateClientSendingRate(e){let s;if(this.updateMeasuredRate(),cr(e)){const n=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=n,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),s=this.cubicThrottle(n),this.enableTokenBucket()}else this.calculateTimeWindow(),s=this.cubicSuccess(this.getCurrentTimeInSeconds());const r=Math.min(s,2*this.measuredTxRate);this.updateTokenBucketRate(r)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),s=Math.floor(e*2)/2;if(this.requestCount++,s>this.lastTxRateBucket){const r=this.requestCount/(s-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(r*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=s}}getPrecise(e){return parseFloat(e.toFixed(8))}}const xt=100,lr=20*1e3,ji=500,ms=500,Ki=5,Wi=10,Gi=1,Vi="amz-sdk-invocation-id",Qi="amz-sdk-request",Xi=()=>{let t=xt;return{computeNextBackoffDelay:r=>Math.floor(Math.min(lr,Math.random()*2**r*t)),setDelayBase:r=>{t=r}}},gs=({retryDelay:t,retryCount:e,retryCost:s})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(lr,t),getRetryCost:()=>s});class dr{constructor(e){this.maxAttempts=e,this.mode=we.STANDARD,this.capacity=ms,this.retryBackoffStrategy=Xi(),this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return gs({retryDelay:xt,retryCount:0})}async refreshRetryTokenForRetry(e,s){const r=await this.getMaxAttempts();if(this.shouldRetry(e,s,r)){const n=s.errorType;this.retryBackoffStrategy.setDelayBase(n==="THROTTLING"?ji:xt);const i=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),o=s.retryAfterHint?Math.max(s.retryAfterHint.getTime()-Date.now()||0,i):i,a=this.getCapacityCost(n);return this.capacity-=a,gs({retryDelay:o,retryCount:e.getRetryCount()+1,retryCost:a})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(ms,this.capacity+(e.getRetryCost()??Gi))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Qe}`),Qe}}shouldRetry(e,s,r){return e.getRetryCount()+1<r&&this.capacity>=this.getCapacityCost(s.errorType)&&this.isRetryableError(s.errorType)}getCapacityCost(e){return e==="TRANSIENT"?Wi:Ki}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class Ji{constructor(e,s){this.maxAttemptsProvider=e,this.mode=we.ADAPTIVE;const{rateLimiter:r}=s??{};this.rateLimiter=r??new qi,this.standardRetryStrategy=new dr(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,s){return this.rateLimiter.updateClientSendingRate(s),this.standardRetryStrategy.refreshRetryTokenForRetry(e,s)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}let Fe;const Zi=new Uint8Array(16);function Yi(){if(!Fe&&(Fe=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Fe))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Fe(Zi)}const O=[];for(let t=0;t<256;++t)O.push((t+256).toString(16).slice(1));function eo(t,e=0){return O[t[e+0]]+O[t[e+1]]+O[t[e+2]]+O[t[e+3]]+"-"+O[t[e+4]]+O[t[e+5]]+"-"+O[t[e+6]]+O[t[e+7]]+"-"+O[t[e+8]]+O[t[e+9]]+"-"+O[t[e+10]]+O[t[e+11]]+O[t[e+12]]+O[t[e+13]]+O[t[e+14]]+O[t[e+15]]}const to=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ys={randomUUID:to};function so(t,e,s){if(ys.randomUUID&&!e&&!t)return ys.randomUUID();t=t||{};const r=t.random||(t.rng||Yi)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,eo(r)}const ro=t=>t instanceof Error?t:t instanceof Object?Object.assign(new Error,t):typeof t=="string"?new Error(t):new Error(`AWS SDK error wrapper for ${t}`),no=t=>{const{retryStrategy:e}=t,s=ie(t.maxAttempts??Qe);return{...t,maxAttempts:s,retryStrategy:async()=>e||(await ie(t.retryMode)()===we.ADAPTIVE?new Ji(s):new dr(s))}};class hr{trace(){}debug(){}info(){}warn(){}error(){}}const ce=(t,e)=>{const s=[];if(t&&s.push(t),e)for(const r of e)s.push(r);return s},ee=(t,e)=>`${t||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,Xe=()=>{let t=[],e=[],s=!1;const r=new Set,n=l=>l.sort((h,f)=>ws[f.step]-ws[h.step]||bs[f.priority||"normal"]-bs[h.priority||"normal"]),i=l=>{let h=!1;const f=m=>{const w=ce(m.name,m.aliases);if(w.includes(l)){h=!0;for(const g of w)r.delete(g);return!1}return!0};return t=t.filter(f),e=e.filter(f),h},o=l=>{let h=!1;const f=m=>{if(m.middleware===l){h=!0;for(const w of ce(m.name,m.aliases))r.delete(w);return!1}return!0};return t=t.filter(f),e=e.filter(f),h},a=l=>{var h;return t.forEach(f=>{l.add(f.middleware,{...f})}),e.forEach(f=>{l.addRelativeTo(f.middleware,{...f})}),(h=l.identifyOnResolve)==null||h.call(l,d.identifyOnResolve()),l},c=l=>{const h=[];return l.before.forEach(f=>{f.before.length===0&&f.after.length===0?h.push(f):h.push(...c(f))}),h.push(l),l.after.reverse().forEach(f=>{f.before.length===0&&f.after.length===0?h.push(f):h.push(...c(f))}),h},u=(l=!1)=>{const h=[],f=[],m={};return t.forEach(g=>{const v={...g,before:[],after:[]};for(const _ of ce(v.name,v.aliases))m[_]=v;h.push(v)}),e.forEach(g=>{const v={...g,before:[],after:[]};for(const _ of ce(v.name,v.aliases))m[_]=v;f.push(v)}),f.forEach(g=>{if(g.toMiddleware){const v=m[g.toMiddleware];if(v===void 0){if(l)return;throw new Error(`${g.toMiddleware} is not found when adding ${ee(g.name,g.aliases)} middleware ${g.relation} ${g.toMiddleware}`)}g.relation==="after"&&v.after.push(g),g.relation==="before"&&v.before.push(g)}}),n(h).map(c).reduce((g,v)=>(g.push(...v),g),[])},d={add:(l,h={})=>{const{name:f,override:m,aliases:w}=h,g={step:"initialize",priority:"normal",middleware:l,...h},v=ce(f,w);if(v.length>0){if(v.some(_=>r.has(_))){if(!m)throw new Error(`Duplicate middleware name '${ee(f,w)}'`);for(const _ of v){const I=t.findIndex(V=>{var Ae;return V.name===_||((Ae=V.aliases)==null?void 0:Ae.some(rt=>rt===_))});if(I===-1)continue;const T=t[I];if(T.step!==g.step||g.priority!==T.priority)throw new Error(`"${ee(T.name,T.aliases)}" middleware with ${T.priority} priority in ${T.step} step cannot be overridden by "${ee(f,w)}" middleware with ${g.priority} priority in ${g.step} step.`);t.splice(I,1)}}for(const _ of v)r.add(_)}t.push(g)},addRelativeTo:(l,h)=>{const{name:f,override:m,aliases:w}=h,g={middleware:l,...h},v=ce(f,w);if(v.length>0){if(v.some(_=>r.has(_))){if(!m)throw new Error(`Duplicate middleware name '${ee(f,w)}'`);for(const _ of v){const I=e.findIndex(V=>{var Ae;return V.name===_||((Ae=V.aliases)==null?void 0:Ae.some(rt=>rt===_))});if(I===-1)continue;const T=e[I];if(T.toMiddleware!==g.toMiddleware||T.relation!==g.relation)throw new Error(`"${ee(T.name,T.aliases)}" middleware ${T.relation} "${T.toMiddleware}" middleware cannot be overridden by "${ee(f,w)}" middleware ${g.relation} "${g.toMiddleware}" middleware.`);e.splice(I,1)}}for(const _ of v)r.add(_)}e.push(g)},clone:()=>a(Xe()),use:l=>{l.applyToStack(d)},remove:l=>typeof l=="string"?i(l):o(l),removeByTag:l=>{let h=!1;const f=m=>{const{tags:w,name:g,aliases:v}=m;if(w&&w.includes(l)){const _=ce(g,v);for(const I of _)r.delete(I);return h=!0,!1}return!0};return t=t.filter(f),e=e.filter(f),h},concat:l=>{var f;const h=a(Xe());return h.use(l),h.identifyOnResolve(s||h.identifyOnResolve()||(((f=l.identifyOnResolve)==null?void 0:f.call(l))??!1)),h},applyToStack:a,identify:()=>u(!0).map(l=>{const h=l.step??l.relation+" "+l.toMiddleware;return ee(l.name,l.aliases)+" - "+h}),identifyOnResolve(l){return typeof l=="boolean"&&(s=l),s},resolve:(l,h)=>{for(const f of u().map(m=>m.middleware).reverse())l=f(l,h);return s&&console.log(d.identify()),l}};return d},ws={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},bs={high:3,normal:2,low:1};class io{constructor(e){this.middlewareStack=Xe(),this.config=e}send(e,s,r){const n=typeof s!="function"?s:void 0,i=typeof s=="function"?s:r,o=e.resolveMiddleware(this.middlewareStack,this.config,n);if(i)o(e).then(a=>i(null,a.output),a=>i(a)).catch(()=>{});else return o(e).then(a=>a.output)}destroy(){this.config.requestHandler.destroy&&this.config.requestHandler.destroy()}}const ae={},Ee=new Array(64);for(let t=0,e=65,s=90;t+e<=s;t++){const r=String.fromCharCode(t+e);ae[r]=t,Ee[t]=r}for(let t=0,e=97,s=122;t+e<=s;t++){const r=String.fromCharCode(t+e),n=t+26;ae[r]=n,Ee[n]=r}for(let t=0;t<10;t++){ae[t.toString(10)]=t+52;const e=t.toString(10),s=t+52;ae[e]=s,Ee[s]=e}ae["+"]=62;Ee[62]="+";ae["/"]=63;Ee[63]="/";const ye=6,Ce=8,oo=63,Ft=t=>{let e=t.length/4*3;t.slice(-2)==="=="?e-=2:t.slice(-1)==="="&&e--;const s=new ArrayBuffer(e),r=new DataView(s);for(let n=0;n<t.length;n+=4){let i=0,o=0;for(let u=n,d=n+3;u<=d;u++)if(t[u]!=="="){if(!(t[u]in ae))throw new TypeError(`Invalid character ${t[u]} in base64 string.`);i|=ae[t[u]]<<(d-u)*ye,o+=ye}else i>>=ye;const a=n/4*3;i>>=o%Ce;const c=Math.floor(o/Ce);for(let u=0;u<c;u++){const d=(c-u-1)*Ce;r.setUint8(a+u,(i&255<<d)>>d)}}return new Uint8Array(s)},be=t=>new TextEncoder().encode(t),_e=t=>typeof t=="string"?be(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t),pr=t=>{if(typeof t=="string")return t;if(typeof t!="object"||typeof t.byteOffset!="number"||typeof t.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(t)};function fr(t){let e;typeof t=="string"?e=be(t):e=t;const s=typeof e=="object"&&typeof e.length=="number",r=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!s&&!r)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let n="";for(let i=0;i<e.length;i+=3){let o=0,a=0;for(let u=i,d=Math.min(i+3,e.length);u<d;u++)o|=e[u]<<(d-u-1)*Ce,a+=Ce;const c=Math.ceil(a/ye);o<<=c*ye-a;for(let u=1;u<=c;u++){const d=(c-u)*ye;n+=Ee[(o&oo<<d)>>d]}n+="==".slice(0,4-c)}return n}function ao(t,e="utf-8"){return e==="base64"?fr(t):pr(t)}function co(t,e){return e==="base64"?he.mutate(Ft(t)):he.mutate(be(t))}class he extends Uint8Array{static fromString(e,s="utf-8"){switch(typeof e){case"string":return co(e,s);default:throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}}static mutate(e){return Object.setPrototypeOf(e,he.prototype),e}transformToString(e="utf-8"){return ao(this,e)}}const ne=t=>encodeURIComponent(t).replace(/[!'()*]/g,uo),uo=t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`;function lo(t){const e=[];for(let s of Object.keys(t).sort()){const r=t[s];if(s=ne(s),Array.isArray(r))for(let n=0,i=r.length;n<i;n++)e.push(`${s}=${ne(r[n])}`);else{let n=s;(r||typeof r=="string")&&(n+=`=${ne(r)}`),e.push(n)}}return e.join("&")}function ho(t=0){return new Promise((e,s)=>{t&&setTimeout(()=>{const r=new Error(`Request did not complete within ${t} ms`);r.name="TimeoutError",s(r)},t)})}const ct={supported:void 0};class Nt{static create(e){return typeof(e==null?void 0:e.handle)=="function"?e:new Nt(e)}constructor(e){typeof e=="function"?this.configProvider=e().then(s=>s||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),ct.supported===void 0&&(ct.supported=typeof Request<"u"&&"keepalive"in new Request("https://[::1]"))}destroy(){}async handle(e,{abortSignal:s}={}){this.config||(this.config=await this.configProvider);const r=this.config.requestTimeout,n=this.config.keepAlive===!0,i=this.config.credentials;if(s!=null&&s.aborted){const v=new Error("Request aborted");return v.name="AbortError",Promise.reject(v)}let o=e.path;const a=lo(e.query||{});a&&(o+=`?${a}`),e.fragment&&(o+=`#${e.fragment}`);let c="";if(e.username!=null||e.password!=null){const v=e.username??"",_=e.password??"";c=`${v}:${_}@`}const{port:u,method:d}=e,l=`${e.protocol}//${c}${e.hostname}${u?`:${u}`:""}${o}`,h=d==="GET"||d==="HEAD"?void 0:e.body,f={body:h,headers:new Headers(e.headers),method:d,credentials:i};h&&(f.duplex="half"),typeof AbortController<"u"&&(f.signal=s),ct.supported&&(f.keepalive=n);let m=()=>{};const w=new Request(l,f),g=[fetch(w).then(v=>{const _=v.headers,I={};for(const V of _.entries())I[V[0]]=V[1];return v.body!=null?{response:new We({headers:I,reason:v.statusText,statusCode:v.status,body:v.body})}:v.blob().then(V=>({response:new We({headers:I,reason:v.statusText,statusCode:v.status,body:V})}))}),ho(r)];return s&&g.push(new Promise((v,_)=>{const I=()=>{const T=new Error("Request aborted");T.name="AbortError",_(T)};if(typeof s.addEventListener=="function"){const T=s;T.addEventListener("abort",I,{once:!0}),m=()=>T.removeEventListener("abort",I)}else s.onabort=I})),Promise.race(g).finally(m)}updateHttpClientConfig(e,s){this.config=void 0,this.configProvider=this.configProvider.then(r=>(r[e]=s,r))}httpHandlerConfigs(){return this.config??{}}}const po=t=>typeof Blob=="function"&&t instanceof Blob?fo(t):mo(t);async function fo(t){const e=await go(t),s=Ft(e);return new Uint8Array(s)}async function mo(t){const e=[],s=t.getReader();let r=!1,n=0;for(;!r;){const{done:a,value:c}=await s.read();c&&(e.push(c),n+=c.length),r=a}const i=new Uint8Array(n);let o=0;for(const a of e)i.set(a,o),o+=a.length;return i}function go(t){return new Promise((e,s)=>{const r=new FileReader;r.onloadend=()=>{if(r.readyState!==2)return s(new Error("Reader aborted too early"));const n=r.result??"",i=n.indexOf(","),o=i>-1?i+1:n.length;e(n.substring(o))},r.onabort=()=>s(new Error("Read aborted")),r.onerror=()=>s(r.error),r.readAsDataURL(t)})}const mr={},Et={};for(let t=0;t<256;t++){let e=t.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),mr[t]=e,Et[e]=t}function gr(t){if(t.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(t.length/2);for(let s=0;s<t.length;s+=2){const r=t.slice(s,s+2).toLowerCase();if(r in Et)e[s/2]=Et[r];else throw new Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`)}return e}function z(t){let e="";for(let s=0;s<t.byteLength;s++)e+=mr[t[s]];return e}const yo=async(t=new Uint8Array,e)=>{if(t instanceof Uint8Array)return he.mutate(t);if(!t)return he.mutate(new Uint8Array);const s=e.streamCollector(t);return he.mutate(await s)};class yr{constructor(){this.middlewareStack=Xe()}static classBuilder(){return new wo}resolveMiddlewareWithContext(e,s,r,{middlewareFn:n,clientName:i,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:c,smithyContext:u,additionalContext:d,CommandCtor:l}){for(const g of n.bind(this)(l,e,s,r))this.middlewareStack.use(g);const h=e.concat(this.middlewareStack),{logger:f}=s,m={logger:f,clientName:i,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:c,[vt]:{commandInstance:this,...u},...d},{requestHandler:w}=s;return h.resolve(g=>w.handle(g.request,r||{}),m)}}class wo{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=e=>e,this._outputFilterSensitiveLog=e=>e,this._serializer=null,this._deserializer=null}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,s,r={}){return this._smithyContext={service:e,operation:s,...r},this}c(e={}){return this._additionalContext=e,this}n(e,s){return this._clientName=e,this._commandName=s,this}f(e=r=>r,s=r=>r){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=s,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}build(){const e=this;let s;return s=class extends yr{static getEndpointParameterInstructions(){return e._ep}constructor(...[r]){super(),this.serialize=e._serializer,this.deserialize=e._deserializer,this.input=r??{},e._init(this)}resolveMiddleware(r,n,i){return this.resolveMiddlewareWithContext(r,n,i,{CommandCtor:s,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog,outputFilterSensitiveLog:e._outputFilterSensitiveLog,smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}class $t extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,$t.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}}const N=(t,e={})=>{Object.entries(e).filter(([,r])=>r!==void 0).forEach(([r,n])=>{(t[r]==null||t[r]==="")&&(t[r]=n)});const s=t.message||t.Message||"UnknownError";return t.message=s,delete t.Message,t},bo=({output:t,parsedBody:e,exceptionCtor:s,errorCode:r})=>{const n=vo(t),i=n.httpStatusCode?n.httpStatusCode+"":void 0,o=new s({name:(e==null?void 0:e.code)||(e==null?void 0:e.Code)||r||i||"UnknownError",$fault:"client",$metadata:n});throw N(o,e)},So=t=>({output:e,parsedBody:s,errorCode:r})=>{bo({output:e,parsedBody:s,exceptionCtor:t,errorCode:r})},vo=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),xo=t=>{switch(t){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},Eo=t=>{const e=[];for(const s in Ke){const r=Ke[s];t[r]!==void 0&&e.push({algorithmId:()=>r,checksumConstructor:()=>t[r]})}return{_checksumAlgorithms:e,addChecksumAlgorithm(s){this._checksumAlgorithms.push(s)},checksumAlgorithms(){return this._checksumAlgorithms}}},Ao=t=>{const e={};return t.checksumAlgorithms().forEach(s=>{e[s.algorithmId()]=s.checksumConstructor()}),e},Ro=t=>{let e=t.retryStrategy;return{setRetryStrategy(s){e=s},retryStrategy(){return e}}},Co=t=>{const e={};return e.retryStrategy=t.retryStrategy(),e},_o=t=>({...Eo(t),...Ro(t)}),ko=t=>({...Ao(t),...Co(t)}),At=function(){const t=Object.getPrototypeOf(this).constructor,e=Function.bind.apply(String,[null,...arguments]),s=new e;return Object.setPrototypeOf(s,t.prototype),s};At.prototype=Object.create(String.prototype,{constructor:{value:At,enumerable:!1,writable:!0,configurable:!0}});Object.setPrototypeOf(At,String);const wr=(t,e)=>{const s={};for(const r in e)Do(s,t,e,r);return s},Do=(t,e,s,r)=>{if(e!==null){let o=s[r];typeof o=="function"&&(o=[,o]);const[a=To,c=Bo,u=r]=o;(typeof a=="function"&&a(e[u])||typeof a!="function"&&a)&&(t[r]=c(e[u]));return}let[n,i]=s[r];if(typeof i=="function"){let o;const a=n===void 0&&(o=i())!=null,c=typeof n=="function"&&!!n(void 0)||typeof n!="function"&&!!n;a?t[r]=o:c&&(t[r]=i())}else{const o=n===void 0&&i!=null,a=typeof n=="function"&&!!n(i)||typeof n!="function"&&!!n;(o||a)&&(t[r]=i)}},To=t=>t!=null,Bo=t=>t,M=t=>{if(t==null)return{};if(Array.isArray(t))return t.filter(e=>e!=null).map(M);if(typeof t=="object"){const e={};for(const s of Object.keys(t))t[s]!=null&&(e[s]=M(t[s]));return e}return t},Io=t=>(t==null?void 0:t.body)instanceof ReadableStream,Mo=t=>(e,s)=>async r=>{var o;let n=await t.retryStrategy();const i=await t.maxAttempts();if(Po(n)){n=n;let a=await n.acquireInitialRetryToken(s.partition_id),c=new Error,u=0,d=0;const{request:l}=r,h=q.isInstance(l);for(h&&(l.headers[Vi]=so());;)try{h&&(l.headers[Qi]=`attempt=${u+1}; max=${i}`);const{response:f,output:m}=await e(r);return n.recordSuccess(a),m.$metadata.attempts=u+1,m.$metadata.totalRetryDelay=d,{response:f,output:m}}catch(f){const m=Oo(f);if(c=ro(f),h&&Io(l))throw(o=s.logger instanceof hr?console:s.logger)==null||o.warn("An error was encountered in a non-retryable streaming request."),c;try{a=await n.refreshRetryTokenForRetry(a,m)}catch{throw c.$metadata||(c.$metadata={}),c.$metadata.attempts=u+1,c.$metadata.totalRetryDelay=d,c}u=a.getRetryCount();const w=a.getRetryDelay();d+=w,await new Promise(g=>setTimeout(g,w))}}else return n=n,n!=null&&n.mode&&(s.userAgent=[...s.userAgent||[],["cfg/retry-mode",n.mode]]),n.retry(e,r)},Po=t=>typeof t.acquireInitialRetryToken<"u"&&typeof t.refreshRetryTokenForRetry<"u"&&typeof t.recordSuccess<"u",Oo=t=>{const e={error:t,errorType:Fo(t)},s=$o(t.$response);return s&&(e.retryAfterHint=s),e},Fo=t=>cr(t)?"THROTTLING":ur(t)?"TRANSIENT":zi(t)?"SERVER_ERROR":"CLIENT_ERROR",br={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},No=t=>({applyToStack:e=>{e.add(Mo(t),br)}}),$o=t=>{if(!We.isInstance(t))return;const e=Object.keys(t.headers).find(i=>i.toLowerCase()==="retry-after");if(!e)return;const s=t.headers[e],r=Number(s);return Number.isNaN(r)?new Date(s):new Date(r*1e3)},Lo={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:br.name},Uo=t=>({applyToStack:e=>{e.addRelativeTo(Oi(),Lo)}});class Ho{constructor(e){this.authSchemes=new Map;for(const[s,r]of Object.entries(e))r!==void 0&&this.authSchemes.set(s,r)}getIdentityProvider(e){return this.authSchemes.get(e)}}const zo=t=>e=>Sr(e)&&e.expiration.getTime()-Date.now()<t,qo=3e5,jo=zo(qo),Sr=t=>t.expiration!==void 0,Ko=(t,e,s)=>{if(t===void 0)return;const r=typeof t!="function"?async()=>Promise.resolve(t):t;let n,i,o,a=!1;const c=async u=>{i||(i=r(u));try{n=await i,o=!0,a=!1}finally{i=void 0}return n};return e===void 0?async u=>((!o||u!=null&&u.forceRefresh)&&(n=await c(u)),n):async u=>((!o||u!=null&&u.forceRefresh)&&(n=await c(u)),a?n:s(n)?(e(n)&&await c(u),n):(a=!0,n))},Ne=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e},Wo=t=>({...t,eventStreamMarshaller:t.eventStreamSerdeProvider(t)}),Ss="content-length";function Go(t){return e=>async s=>{const r=s.request;if(q.isInstance(r)){const{body:n,headers:i}=r;if(n&&Object.keys(i).map(o=>o.toLowerCase()).indexOf(Ss)===-1)try{const o=t(n);r.headers={...r.headers,[Ss]:String(o)}}catch{}}return e({...s,request:r})}}const Vo={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},Qo=t=>({applyToStack:e=>{e.add(Go(t.bodyLengthChecker),Vo)}}),vs=t=>{var e,s;return We.isInstance(t)?((e=t.headers)==null?void 0:e.date)??((s=t.headers)==null?void 0:s.Date):void 0},vr=t=>new Date(Date.now()+t),Xo=(t,e)=>Math.abs(vr(e).getTime()-t)>=3e5,xs=(t,e)=>{const s=Date.parse(t);return Xo(s,e)?s-Date.now():e},ke=(t,e)=>{if(!e)throw new Error(`Property \`${t}\` is not resolved for AWS SDK SigV4Auth`);return e},Jo=async t=>{var u,d,l;const e=ke("context",t.context),s=ke("config",t.config),r=(l=(d=(u=e.endpointV2)==null?void 0:u.properties)==null?void 0:d.authSchemes)==null?void 0:l[0],i=await ke("signer",s.signer)(r),o=t==null?void 0:t.signingRegion,a=t==null?void 0:t.signingRegionSet,c=t==null?void 0:t.signingName;return{config:s,signer:i,signingRegion:o,signingRegionSet:a,signingName:c}};class Zo{async sign(e,s,r){var l;if(!q.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const n=await Jo(r),{config:i,signer:o}=n;let{signingRegion:a,signingName:c}=n;const u=r.context;if(((l=u==null?void 0:u.authSchemes)==null?void 0:l.length)??!1){const[h,f]=u.authSchemes;(h==null?void 0:h.name)==="sigv4a"&&(f==null?void 0:f.name)==="sigv4"&&(a=(f==null?void 0:f.signingRegion)??a,c=(f==null?void 0:f.signingName)??c)}return await o.sign(e,{signingDate:vr(i.systemClockOffset),signingRegion:a,signingService:c})}errorHandler(e){return s=>{const r=s.ServerTime??vs(s.$response);if(r){const n=ke("config",e.config),i=n.systemClockOffset;n.systemClockOffset=xs(r,n.systemClockOffset),n.systemClockOffset!==i&&s.$metadata&&(s.$metadata.clockSkewCorrected=!0)}throw s}}successHandler(e,s){const r=vs(e);if(r){const n=ke("config",s.config);n.systemClockOffset=xs(r,n.systemClockOffset)}}}const Yo=(t,e,s)=>{let r,n,i,o=!1;const a=async()=>{n||(n=t());try{r=await n,i=!0,o=!1}finally{n=void 0}return r};return async c=>((!i||c!=null&&c.forceRefresh)&&(r=await a()),r)},ea="X-Amz-Algorithm",ta="X-Amz-Credential",xr="X-Amz-Date",sa="X-Amz-SignedHeaders",ra="X-Amz-Expires",Er="X-Amz-Signature",Ar="X-Amz-Security-Token",Rr="authorization",Cr=xr.toLowerCase(),na="date",ia=[Rr,Cr,na],oa=Er.toLowerCase(),Rt="x-amz-content-sha256",aa=Ar.toLowerCase(),ca={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},ua=/^proxy-/,la=/^sec-/,ut="AWS4-HMAC-SHA256",da="AWS4-HMAC-SHA256-PAYLOAD",ha="UNSIGNED-PAYLOAD",pa=50,_r="aws4_request",fa=60*60*24*7,$e={},lt=[],dt=(t,e,s)=>`${t}/${e}/${s}/${_r}`,ma=async(t,e,s,r,n)=>{const i=await Es(t,e.secretAccessKey,e.accessKeyId),o=`${s}:${r}:${n}:${z(i)}:${e.sessionToken}`;if(o in $e)return $e[o];for(lt.push(o);lt.length>pa;)delete $e[lt.shift()];let a=`AWS4${e.secretAccessKey}`;for(const c of[s,r,n,_r])a=await Es(t,a,c);return $e[o]=a},Es=(t,e,s)=>{const r=new t(e);return r.update(_e(s)),r.digest()},As=({headers:t},e,s)=>{const r={};for(const n of Object.keys(t).sort()){if(t[n]==null)continue;const i=n.toLowerCase();(i in ca||e!=null&&e.has(i)||ua.test(i)||la.test(i))&&(!s||s&&!s.has(i))||(r[i]=t[n].trim().replace(/\s+/g," "))}return r},ga=({query:t={}})=>{const e=[],s={};for(const r of Object.keys(t).sort()){if(r.toLowerCase()===oa)continue;e.push(r);const n=t[r];typeof n=="string"?s[r]=`${ne(r)}=${ne(n)}`:Array.isArray(n)&&(s[r]=n.slice(0).reduce((i,o)=>i.concat([`${ne(r)}=${ne(o)}`]),[]).sort().join("&"))}return e.map(r=>s[r]).filter(r=>r).join("&")},ya=t=>typeof ArrayBuffer=="function"&&t instanceof ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]",ht=async({headers:t,body:e},s)=>{for(const r of Object.keys(t))if(r.toLowerCase()===Rt)return t[r];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||ya(e)){const r=new s;return r.update(_e(e)),z(await r.digest())}return ha};class wa{format(e){const s=[];for(const i of Object.keys(e)){const o=be(i);s.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[i]))}const r=new Uint8Array(s.reduce((i,o)=>i+o.byteLength,0));let n=0;for(const i of s)r.set(i,n),n+=i.byteLength;return r}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const s=new DataView(new ArrayBuffer(3));return s.setUint8(0,3),s.setInt16(1,e.value,!1),new Uint8Array(s.buffer);case"integer":const r=new DataView(new ArrayBuffer(5));return r.setUint8(0,4),r.setInt32(1,e.value,!1),new Uint8Array(r.buffer);case"long":const n=new Uint8Array(9);return n[0]=5,n.set(e.value.bytes,1),n;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(i.buffer);return o.set(e.value,3),o;case"string":const a=be(e.value),c=new DataView(new ArrayBuffer(3+a.byteLength));c.setUint8(0,7),c.setUint16(1,a.byteLength,!1);const u=new Uint8Array(c.buffer);return u.set(a,3),u;case"timestamp":const d=new Uint8Array(9);return d[0]=8,d.set(Sa.fromNumber(e.value.valueOf()).bytes,1),d;case"uuid":if(!ba.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const l=new Uint8Array(17);return l[0]=9,l.set(gr(e.value.replace(/\-/g,"")),1),l}}}var Rs;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(Rs||(Rs={}));const ba=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;let Sa=class kr{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const s=new Uint8Array(8);for(let r=7,n=Math.abs(Math.round(e));r>-1&&n>0;r--,n/=256)s[r]=n;return e<0&&Cs(s),new kr(s)}valueOf(){const e=this.bytes.slice(0),s=e[0]&128;return s&&Cs(e),parseInt(z(e),16)*(s?-1:1)}toString(){return String(this.valueOf())}};function Cs(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}const va=(t,e)=>{t=t.toLowerCase();for(const s of Object.keys(e))if(t===s.toLowerCase())return!0;return!1},xa=(t,e={})=>{var n;const{headers:s,query:r={}}=q.clone(t);for(const i of Object.keys(s)){const o=i.toLowerCase();o.slice(0,6)==="x-amz-"&&!((n=e.unhoistableHeaders)!=null&&n.has(o))&&(r[i]=s[i],delete s[i])}return{...t,headers:s,query:r}},_s=t=>{t=q.clone(t);for(const e of Object.keys(t.headers))ia.indexOf(e.toLowerCase())>-1&&delete t.headers[e];return t},Ea=t=>Aa(t).toISOString().replace(/\.\d{3}Z$/,"Z"),Aa=t=>typeof t=="number"?new Date(t*1e3):typeof t=="string"?Number(t)?new Date(Number(t)*1e3):new Date(t):t;class ks{constructor({applyChecksum:e,credentials:s,region:r,service:n,sha256:i,uriEscapePath:o=!0}){this.headerFormatter=new wa,this.service=n,this.sha256=i,this.uriEscapePath=o,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=ie(r),this.credentialProvider=ie(s)}async presign(e,s={}){const{signingDate:r=new Date,expiresIn:n=3600,unsignableHeaders:i,unhoistableHeaders:o,signableHeaders:a,signingRegion:c,signingService:u}=s,d=await this.credentialProvider();this.validateResolvedCredentials(d);const l=c??await this.regionProvider(),{longDate:h,shortDate:f}=Le(r);if(n>fa)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const m=dt(f,l,u??this.service),w=xa(_s(e),{unhoistableHeaders:o});d.sessionToken&&(w.query[Ar]=d.sessionToken),w.query[ea]=ut,w.query[ta]=`${d.accessKeyId}/${m}`,w.query[xr]=h,w.query[ra]=n.toString(10);const g=As(w,i,a);return w.query[sa]=Ds(g),w.query[Er]=await this.getSignature(h,m,this.getSigningKey(d,l,f,u),this.createCanonicalRequest(w,g,await ht(e,this.sha256))),w}async sign(e,s){return typeof e=="string"?this.signString(e,s):e.headers&&e.payload?this.signEvent(e,s):e.message?this.signMessage(e,s):this.signRequest(e,s)}async signEvent({headers:e,payload:s},{signingDate:r=new Date,priorSignature:n,signingRegion:i,signingService:o}){const a=i??await this.regionProvider(),{shortDate:c,longDate:u}=Le(r),d=dt(c,a,o??this.service),l=await ht({headers:{},body:s},this.sha256),h=new this.sha256;h.update(e);const f=z(await h.digest()),m=[da,u,d,n,f,l].join(`
`);return this.signString(m,{signingDate:r,signingRegion:a,signingService:o})}async signMessage(e,{signingDate:s=new Date,signingRegion:r,signingService:n}){return this.signEvent({headers:this.headerFormatter.format(e.message.headers),payload:e.message.body},{signingDate:s,signingRegion:r,signingService:n,priorSignature:e.priorSignature}).then(o=>({message:e.message,signature:o}))}async signString(e,{signingDate:s=new Date,signingRegion:r,signingService:n}={}){const i=await this.credentialProvider();this.validateResolvedCredentials(i);const o=r??await this.regionProvider(),{shortDate:a}=Le(s),c=new this.sha256(await this.getSigningKey(i,o,a,n));return c.update(_e(e)),z(await c.digest())}async signRequest(e,{signingDate:s=new Date,signableHeaders:r,unsignableHeaders:n,signingRegion:i,signingService:o}={}){const a=await this.credentialProvider();this.validateResolvedCredentials(a);const c=i??await this.regionProvider(),u=_s(e),{longDate:d,shortDate:l}=Le(s),h=dt(l,c,o??this.service);u.headers[Cr]=d,a.sessionToken&&(u.headers[aa]=a.sessionToken);const f=await ht(u,this.sha256);!va(Rt,u.headers)&&this.applyChecksum&&(u.headers[Rt]=f);const m=As(u,n,r),w=await this.getSignature(d,h,this.getSigningKey(a,c,l,o),this.createCanonicalRequest(u,m,f));return u.headers[Rr]=`${ut} Credential=${a.accessKeyId}/${h}, SignedHeaders=${Ds(m)}, Signature=${w}`,u}createCanonicalRequest(e,s,r){const n=Object.keys(s).sort();return`${e.method}
${this.getCanonicalPath(e)}
${ga(e)}
${n.map(i=>`${i}:${s[i]}`).join(`
`)}

${n.join(";")}
${r}`}async createStringToSign(e,s,r){const n=new this.sha256;n.update(_e(r));const i=await n.digest();return`${ut}
${e}
${s}
${z(i)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const s=[];for(const i of e.split("/"))(i==null?void 0:i.length)!==0&&i!=="."&&(i===".."?s.pop():s.push(i));const r=`${e!=null&&e.startsWith("/")?"/":""}${s.join("/")}${s.length>0&&(e!=null&&e.endsWith("/"))?"/":""}`;return ne(r).replace(/%2F/g,"/")}return e}async getSignature(e,s,r,n){const i=await this.createStringToSign(e,s,n),o=new this.sha256(await r);return o.update(_e(i)),z(await o.digest())}getSigningKey(e,s,r,n){return ma(this.sha256,e,r,s,n||this.service)}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}}const Le=t=>{const e=Ea(t).replace(/[\-:]/g,"");return{longDate:e,shortDate:e.slice(0,8)}},Ds=t=>Object.keys(t).sort().join(";"),Ra=t=>{let e;t.credentials&&(e=Ko(t.credentials,jo,Sr)),e||(t.credentialDefaultProvider?e=Ne(t.credentialDefaultProvider(Object.assign({},t,{parentClientConfig:t}))):e=async()=>{throw new Error("`credentials` is missing")});const{signingEscapePath:s=!0,systemClockOffset:r=t.systemClockOffset||0,sha256:n}=t;let i;return t.signer?i=Ne(t.signer):t.regionInfoProvider?i=()=>Ne(t.region)().then(async o=>[await t.regionInfoProvider(o,{useFipsEndpoint:await t.useFipsEndpoint(),useDualstackEndpoint:await t.useDualstackEndpoint()})||{},o]).then(([o,a])=>{const{signingRegion:c,signingService:u}=o;t.signingRegion=t.signingRegion||c||a,t.signingName=t.signingName||u||t.serviceId;const d={...t,credentials:e,region:t.signingRegion,service:t.signingName,sha256:n,uriEscapePath:s},l=t.signerConstructor||ks;return new l(d)}):i=async o=>{o=Object.assign({},{name:"sigv4",signingName:t.signingName||t.defaultSigningName,signingRegion:await Ne(t.region)(),properties:{}},o);const a=o.signingRegion,c=o.signingName;t.signingRegion=t.signingRegion||a,t.signingName=t.signingName||c||t.serviceId;const u={...t,credentials:e,region:t.signingRegion,service:t.signingName,sha256:n,uriEscapePath:s},d=t.signerConstructor||ks;return new d(u)},{...t,systemClockOffset:r,signingEscapePath:s,credentials:e,signer:i}},Ca=(t,e)=>yo(t,e).then(s=>e.utf8Encoder(s)),Dr=(t,e)=>Ca(t,e).then(s=>{if(s.length)try{return JSON.parse(s)}catch(r){throw(r==null?void 0:r.name)==="SyntaxError"&&Object.defineProperty(r,"$responseBodyText",{value:s}),r}return{}}),_a=async(t,e)=>{const s=await Dr(t,e);return s.message=s.message??s.Message,s},ka=(t,e)=>{const s=(i,o)=>Object.keys(i).find(a=>a.toLowerCase()===o.toLowerCase()),r=i=>{let o=i;return typeof o=="number"&&(o=o.toString()),o.indexOf(",")>=0&&(o=o.split(",")[0]),o.indexOf(":")>=0&&(o=o.split(":")[0]),o.indexOf("#")>=0&&(o=o.split("#")[1]),o},n=s(t.headers,"x-amzn-errortype");if(n!==void 0)return r(t.headers[n]);if(e.code!==void 0)return r(e.code);if(e.__type!==void 0)return r(e.__type)},Da=async(t,e,s)=>({operation:st(e).operation,region:await ie(t.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function Ta(t){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"kinesis",region:t.region},propertiesExtractor:(e,s)=>({signingProperties:{config:e,context:s}})}}const Ba=t=>{const e=[];switch(t.operation){default:e.push(Ta(t))}return e},Ia=t=>({...Ra(t)}),Ma=t=>({...t,useDualstackEndpoint:t.useDualstackEndpoint??!1,useFipsEndpoint:t.useFipsEndpoint??!1,defaultSigningName:"kinesis"}),Pa={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},Oa="@aws-sdk/client-kinesis",Fa="AWS SDK for JavaScript Kinesis Client for Node.js, Browser and React Native",Na="3.637.0",$a={build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-kinesis","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo kinesis","test:e2e":"jest --config jest.config.e2e.js"},La="./dist-cjs/index.js",Ua="./dist-types/index.d.ts",Ha="./dist-es/index.js",za=!1,qa={"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/client-sso-oidc":"3.637.0","@aws-sdk/client-sts":"3.637.0","@aws-sdk/core":"3.635.0","@aws-sdk/credential-provider-node":"3.637.0","@aws-sdk/middleware-host-header":"3.620.0","@aws-sdk/middleware-logger":"3.609.0","@aws-sdk/middleware-recursion-detection":"3.620.0","@aws-sdk/middleware-user-agent":"3.637.0","@aws-sdk/region-config-resolver":"3.614.0","@aws-sdk/types":"3.609.0","@aws-sdk/util-endpoints":"3.637.0","@aws-sdk/util-user-agent-browser":"3.609.0","@aws-sdk/util-user-agent-node":"3.614.0","@smithy/config-resolver":"^3.0.5","@smithy/core":"^2.4.0","@smithy/eventstream-serde-browser":"^3.0.6","@smithy/eventstream-serde-config-resolver":"^3.0.3","@smithy/eventstream-serde-node":"^3.0.5","@smithy/fetch-http-handler":"^3.2.4","@smithy/hash-node":"^3.0.3","@smithy/invalid-dependency":"^3.0.3","@smithy/middleware-content-length":"^3.0.5","@smithy/middleware-endpoint":"^3.1.0","@smithy/middleware-retry":"^3.0.15","@smithy/middleware-serde":"^3.0.3","@smithy/middleware-stack":"^3.0.3","@smithy/node-config-provider":"^3.1.4","@smithy/node-http-handler":"^3.1.4","@smithy/protocol-http":"^4.1.0","@smithy/smithy-client":"^3.2.0","@smithy/types":"^3.3.0","@smithy/url-parser":"^3.0.3","@smithy/util-base64":"^3.0.0","@smithy/util-body-length-browser":"^3.0.0","@smithy/util-body-length-node":"^3.0.0","@smithy/util-defaults-mode-browser":"^3.0.15","@smithy/util-defaults-mode-node":"^3.0.15","@smithy/util-endpoints":"^2.0.5","@smithy/util-middleware":"^3.0.3","@smithy/util-retry":"^3.0.3","@smithy/util-utf8":"^3.0.0","@smithy/util-waiter":"^3.1.2",tslib:"^2.6.2"},ja={"@tsconfig/node16":"16.1.3","@types/node":"^16.18.96",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~4.9.5"},Ka={node:">=16.0.0"},Wa={"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},Ga=["dist-*/**"],Va={name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},Qa="Apache-2.0",Xa={"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},Ja="https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-kinesis",Za={type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-kinesis"},Ya={name:Oa,description:Fa,version:Na,scripts:$a,main:La,types:Ua,module:Ha,sideEffects:za,dependencies:qa,devDependencies:ja,engines:Ka,typesVersions:Wa,files:Ga,author:Va,license:Qa,browser:Xa,"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:Ja,repository:Za},ec=t=>new TextEncoder().encode(t);var tc=typeof Buffer<"u"&&Buffer.from?function(t){return Buffer.from(t,"utf8")}:ec;function Me(t){return t instanceof Uint8Array?t:typeof t=="string"?tc(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}function Ct(t){return typeof t=="string"?t.length===0:t.byteLength===0}function sc(t){if(!Uint32Array.from){for(var e=new Uint32Array(t.length),s=0;s<t.length;)e[s]=t[s],s+=1;return e}return Uint32Array.from(t)}var Tr={name:"SHA-256"},Ts={name:"HMAC",hash:Tr},rc=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);const nc={};function qe(){return typeof window<"u"?window:typeof self<"u"?self:nc}var ic=function(){function t(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return t.prototype.update=function(e){if(!Ct(e)){var s=Me(e),r=new Uint8Array(this.toHash.byteLength+s.byteLength);r.set(this.toHash,0),r.set(s,this.toHash.byteLength),this.toHash=r}},t.prototype.digest=function(){var e=this;return this.key?this.key.then(function(s){return qe().crypto.subtle.sign(Ts,s,e.toHash).then(function(r){return new Uint8Array(r)})}):Ct(this.toHash)?Promise.resolve(rc):Promise.resolve().then(function(){return qe().crypto.subtle.digest(Tr,e.toHash)}).then(function(s){return Promise.resolve(new Uint8Array(s))})},t.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(s,r){qe().crypto.subtle.importKey("raw",Me(e.secret),Ts,!1,["sign"]).then(s,r)}),this.key.catch(function(){}))},t}();function oc(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(d){try{u(r.next(d))}catch(l){o(l)}}function c(d){try{u(r.throw(d))}catch(l){o(l)}}function u(d){d.done?i(d.value):n(d.value).then(a,c)}u((r=r.apply(t,e||[])).next())})}function ac(t,e){var s={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,n,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(r=1,n&&(i=u[0]&2?n.return:u[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,u[1])).done)return i;switch(n=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){s=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){s.label=u[1];break}if(u[0]===6&&s.label<i[1]){s.label=i[1],i=u;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(u);break}i[2]&&s.ops.pop(),s.trys.pop();continue}u=e.call(t,s)}catch(d){u=[6,d],n=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function cc(t){var e=typeof Symbol=="function"&&Symbol.iterator,s=e&&t[e],r=0;if(s)return s.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var W=64,uc=32,lc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),dc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],hc=Math.pow(2,53)-1,je=function(){function t(){this.state=Int32Array.from(dc),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return t.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var s=0,r=e.byteLength;if(this.bytesHashed+=r,this.bytesHashed*8>hc)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=e[s++],r--,this.bufferLength===W&&(this.hashBuffer(),this.bufferLength=0)},t.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,s=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(s.setUint8(this.bufferLength++,128),r%W>=W-8){for(var n=this.bufferLength;n<W;n++)s.setUint8(n,0);this.hashBuffer(),this.bufferLength=0}for(var n=this.bufferLength;n<W-8;n++)s.setUint8(n,0);s.setUint32(W-8,Math.floor(e/4294967296),!0),s.setUint32(W-4,e),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(uc),n=0;n<8;n++)i[n*4]=this.state[n]>>>24&255,i[n*4+1]=this.state[n]>>>16&255,i[n*4+2]=this.state[n]>>>8&255,i[n*4+3]=this.state[n]>>>0&255;return i},t.prototype.hashBuffer=function(){for(var e=this,s=e.buffer,r=e.state,n=r[0],i=r[1],o=r[2],a=r[3],c=r[4],u=r[5],d=r[6],l=r[7],h=0;h<W;h++){if(h<16)this.temp[h]=(s[h*4]&255)<<24|(s[h*4+1]&255)<<16|(s[h*4+2]&255)<<8|s[h*4+3]&255;else{var f=this.temp[h-2],m=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10;f=this.temp[h-15];var w=(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[h]=(m+this.temp[h-7]|0)+(w+this.temp[h-16]|0)}var g=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&u^~c&d)|0)+(l+(lc[h]+this.temp[h]|0)|0)|0,v=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&i^n&o^i&o)|0;l=d,d=u,u=c,c=a+g|0,a=o,o=i,i=n,n=g+v|0}r[0]+=n,r[1]+=i,r[2]+=o,r[3]+=a,r[4]+=c,r[5]+=u,r[6]+=d,r[7]+=l},t}(),pc=function(){function t(e){this.secret=e,this.hash=new je,this.reset()}return t.prototype.update=function(e){if(!(Ct(e)||this.error))try{this.hash.update(Me(e))}catch(s){this.error=s}},t.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},t.prototype.digest=function(){return oc(this,void 0,void 0,function(){return ac(this,function(e){return[2,this.digestSync()]})})},t.prototype.reset=function(){if(this.hash=new je,this.secret){this.outer=new je;var e=fc(this.secret),s=new Uint8Array(W);s.set(e);for(var r=0;r<W;r++)e[r]^=54,s[r]^=92;this.hash.update(e),this.outer.update(s);for(var r=0;r<e.byteLength;r++)e[r]=0}},t}();function fc(t){var e=Me(t);if(e.byteLength>W){var s=new je;s.update(e),e=s.digest()}var r=new Uint8Array(W);return r.set(e),r}var mc=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function gc(t){if(yc(t)&&typeof t.crypto.subtle=="object"){var e=t.crypto.subtle;return wc(e)}return!1}function yc(t){if(typeof t=="object"&&typeof t.crypto=="object"){var e=t.crypto.getRandomValues;return typeof e=="function"}return!1}function wc(t){return t&&mc.every(function(e){return typeof t[e]=="function"})}var bc=function(){function t(e){gc(qe())?this.hash=new ic(e):this.hash=new pc(e)}return t.prototype.update=function(e,s){this.hash.update(Me(e))},t.prototype.digest=function(){return this.hash.digest()},t.prototype.reset=function(){this.hash.reset()},t}();const Sc={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},Br={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},D={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},L={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},te={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class p{static getFirstMatch(e,s){const r=s.match(e);return r&&r.length>0&&r[1]||""}static getSecondMatch(e,s){const r=s.match(e);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(e,s,r){if(e.test(s))return r}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const s=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(s.push(0),s[0]===10)switch(s[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const s=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(s.push(0),!(s[0]===1&&s[1]<5)){if(s[0]===1&&s[1]<6)return"Cupcake";if(s[0]===1&&s[1]>=6)return"Donut";if(s[0]===2&&s[1]<2)return"Eclair";if(s[0]===2&&s[1]===2)return"Froyo";if(s[0]===2&&s[1]>2)return"Gingerbread";if(s[0]===3)return"Honeycomb";if(s[0]===4&&s[1]<1)return"Ice Cream Sandwich";if(s[0]===4&&s[1]<4)return"Jelly Bean";if(s[0]===4&&s[1]>=4)return"KitKat";if(s[0]===5)return"Lollipop";if(s[0]===6)return"Marshmallow";if(s[0]===7)return"Nougat";if(s[0]===8)return"Oreo";if(s[0]===9)return"Pie"}}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,s,r=!1){const n=p.getVersionPrecision(e),i=p.getVersionPrecision(s);let o=Math.max(n,i),a=0;const c=p.map([e,s],u=>{const d=o-p.getVersionPrecision(u),l=u+new Array(d+1).join(".0");return p.map(l.split("."),h=>new Array(20-h.length).join("0")+h).reverse()});for(r&&(a=o-Math.min(n,i)),o-=1;o>=a;){if(c[0][o]>c[1][o])return 1;if(c[0][o]===c[1][o]){if(o===a)return 0;o-=1}else if(c[0][o]<c[1][o])return-1}}static map(e,s){const r=[];let n;if(Array.prototype.map)return Array.prototype.map.call(e,s);for(n=0;n<e.length;n+=1)r.push(s(e[n]));return r}static find(e,s){let r,n;if(Array.prototype.find)return Array.prototype.find.call(e,s);for(r=0,n=e.length;r<n;r+=1){const i=e[r];if(s(i,r))return i}}static assign(e,...s){const r=e;let n,i;if(Object.assign)return Object.assign(e,...s);for(n=0,i=s.length;n<i;n+=1){const o=s[n];typeof o=="object"&&o!==null&&Object.keys(o).forEach(c=>{r[c]=o[c]})}return e}static getBrowserAlias(e){return Sc[e]}static getBrowserTypeByAlias(e){return Br[e]||""}}const k=/version\/(\d+(\.?_?\d+)+)/i,vc=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},s=p.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},s=p.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},s=p.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},s=p.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},s=p.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},s=p.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},s=p.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},s=p.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},s=p.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},s=p.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},s=p.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},s=p.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},s=p.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},s=p.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},s=p.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return s&&(e.version=s),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},s=p.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},s=p.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},s=p.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},s=p.getFirstMatch(k,t)||p.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},s=p.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},s=p.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},s=p.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},s=p.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},s=p.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},s=p.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},s=p.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},s=p.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},s=p.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test(t){const e=!t.test(/like android/i),s=t.test(/android/i);return e&&s},describe(t){const e={name:"Android Browser"},s=p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},s=p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},s=p.getFirstMatch(k,t);return s&&(e.version=s),e}},{test:[/.*/i],describe(t){const e=/^(.*)\/(.*) /,s=/^(.*)\/(.*)[ \t]\((.*)/,n=t.search("\\(")!==-1?s:e;return{name:p.getFirstMatch(n,t),version:p.getSecondMatch(n,t)}}}],xc=[{test:[/Roku\/DVP/],describe(t){const e=p.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:L.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=p.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:L.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=p.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),s=p.getWindowsVersionName(e);return{name:L.Windows,version:e,versionName:s}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:L.iOS},s=p.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return s&&(e.version=s),e}},{test:[/macintosh/i],describe(t){const e=p.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),s=p.getMacOSVersionName(e),r={name:L.MacOS,version:e};return s&&(r.versionName=s),r}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=p.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:L.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),s=t.test(/android/i);return e&&s},describe(t){const e=p.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),s=p.getAndroidVersionName(e),r={name:L.Android,version:e};return s&&(r.versionName=s),r}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=p.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),s={name:L.WebOS};return e&&e.length&&(s.version=e),s}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=p.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||p.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||p.getFirstMatch(/\bbb(\d+)/i,t);return{name:L.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=p.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:L.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=p.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:L.Tizen,version:e}}},{test:[/linux/i],describe(){return{name:L.Linux}}},{test:[/CrOS/],describe(){return{name:L.ChromeOS}}},{test:[/PlayStation 4/],describe(t){const e=p.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:L.PlayStation4,version:e}}}],Ec=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(t){const e=p.getFirstMatch(/(can-l01)/i,t)&&"Nova",s={type:D.mobile,vendor:"Huawei"};return e&&(s.model=e),s}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:D.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:D.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:D.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:D.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:D.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:D.tablet}}},{test(t){const e=t.test(/ipod|iphone/i),s=t.test(/like (ipod|iphone)/i);return e&&!s},describe(t){const e=p.getFirstMatch(/(ipod|iphone)/i,t);return{type:D.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:D.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:D.mobile}}},{test(t){return t.getBrowserName(!0)==="blackberry"},describe(){return{type:D.mobile,vendor:"BlackBerry"}}},{test(t){return t.getBrowserName(!0)==="bada"},describe(){return{type:D.mobile}}},{test(t){return t.getBrowserName()==="windows phone"},describe(){return{type:D.mobile,vendor:"Microsoft"}}},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return t.getOSName(!0)==="android"&&e>=3},describe(){return{type:D.tablet}}},{test(t){return t.getOSName(!0)==="android"},describe(){return{type:D.mobile}}},{test(t){return t.getOSName(!0)==="macos"},describe(){return{type:D.desktop,vendor:"Apple"}}},{test(t){return t.getOSName(!0)==="windows"},describe(){return{type:D.desktop}}},{test(t){return t.getOSName(!0)==="linux"},describe(){return{type:D.desktop}}},{test(t){return t.getOSName(!0)==="playstation 4"},describe(){return{type:D.tv}}},{test(t){return t.getOSName(!0)==="roku"},describe(){return{type:D.tv}}}],Ac=[{test(t){return t.getBrowserName(!0)==="microsoft edge"},describe(t){if(/\sedg\//i.test(t))return{name:te.Blink};const s=p.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:te.EdgeHTML,version:s}}},{test:[/trident/i],describe(t){const e={name:te.Trident},s=p.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test(t){return t.test(/presto/i)},describe(t){const e={name:te.Presto},s=p.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test(t){const e=t.test(/gecko/i),s=t.test(/like gecko/i);return e&&!s},describe(t){const e={name:te.Gecko},s=p.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:te.Blink}}},{test:[/(apple)?webkit/i],describe(t){const e={name:te.WebKit},s=p.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return s&&(e.version=s),e}}];class Bs{constructor(e,s=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},s!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=p.find(vc,s=>{if(typeof s.test=="function")return s.test(this);if(s.test instanceof Array)return s.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=p.find(xc,s=>{if(typeof s.test=="function")return s.test(this);if(s.test instanceof Array)return s.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:s}=this.getOS();return e?String(s).toLowerCase()||"":s||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:s}=this.getPlatform();return e?String(s).toLowerCase()||"":s||""}parsePlatform(){this.parsedResult.platform={};const e=p.find(Ec,s=>{if(typeof s.test=="function")return s.test(this);if(s.test instanceof Array)return s.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=p.find(Ac,s=>{if(typeof s.test=="function")return s.test(this);if(s.test instanceof Array)return s.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return p.assign({},this.parsedResult)}satisfies(e){const s={};let r=0;const n={};let i=0;if(Object.keys(e).forEach(a=>{const c=e[a];typeof c=="string"?(n[a]=c,i+=1):typeof c=="object"&&(s[a]=c,r+=1)}),r>0){const a=Object.keys(s),c=p.find(a,d=>this.isOS(d));if(c){const d=this.satisfies(s[c]);if(d!==void 0)return d}const u=p.find(a,d=>this.isPlatform(d));if(u){const d=this.satisfies(s[u]);if(d!==void 0)return d}}if(i>0){const a=Object.keys(n),c=p.find(a,u=>this.isBrowser(u,!0));if(c!==void 0)return this.compareVersion(n[c])}}isBrowser(e,s=!1){const r=this.getBrowserName().toLowerCase();let n=e.toLowerCase();const i=p.getBrowserTypeByAlias(n);return s&&i&&(n=i.toLowerCase()),n===r}compareVersion(e){let s=[0],r=e,n=!1;const i=this.getBrowserVersion();if(typeof i=="string")return e[0]===">"||e[0]==="<"?(r=e.substr(1),e[1]==="="?(n=!0,r=e.substr(2)):s=[],e[0]===">"?s.push(1):s.push(-1)):e[0]==="="?r=e.substr(1):e[0]==="~"&&(n=!0,r=e.substr(1)),s.indexOf(p.compareVersions(i,r,n))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,s=!1){return this.isBrowser(e,s)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(s=>this.is(s))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class Ir{static getParser(e,s=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new Bs(e,s)}static parse(e){return new Bs(e).getResult()}static get BROWSER_MAP(){return Br}static get ENGINE_MAP(){return te}static get OS_MAP(){return L}static get PLATFORMS_MAP(){return D}}const Rc=({serviceId:t,clientVersion:e})=>async()=>{var n,i,o,a,c;const s=typeof window<"u"&&((n=window==null?void 0:window.navigator)!=null&&n.userAgent)?Ir.parse(window.navigator.userAgent):void 0,r=[["aws-sdk-js",e],["ua","2.0"],[`os/${((i=s==null?void 0:s.os)==null?void 0:i.name)||"other"}`,(o=s==null?void 0:s.os)==null?void 0:o.version],["lang/js"],["md/browser",`${((a=s==null?void 0:s.browser)==null?void 0:a.name)??"unknown"}_${((c=s==null?void 0:s.browser)==null?void 0:c.version)??"unknown"}`]];return t&&r.push([`api/${t}`,e]),r};var Mr=function(){function t(){this.checksum=4294967295}return t.prototype.update=function(e){var s,r;try{for(var n=cc(e),i=n.next();!i.done;i=n.next()){var o=i.value;this.checksum=this.checksum>>>8^_c[(this.checksum^o)&255]}}catch(a){s={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return this},t.prototype.digest=function(){return(this.checksum^4294967295)>>>0},t}(),Cc=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],_c=sc(Cc);class De{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const s=new Uint8Array(8);for(let r=7,n=Math.abs(Math.round(e));r>-1&&n>0;r--,n/=256)s[r]=n;return e<0&&Is(s),new De(s)}valueOf(){const e=this.bytes.slice(0),s=e[0]&128;return s&&Is(e),parseInt(z(e),16)*(s?-1:1)}toString(){return String(this.valueOf())}}function Is(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}class kc{constructor(e,s){this.toUtf8=e,this.fromUtf8=s}format(e){const s=[];for(const i of Object.keys(e)){const o=this.fromUtf8(i);s.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[i]))}const r=new Uint8Array(s.reduce((i,o)=>i+o.byteLength,0));let n=0;for(const i of s)r.set(i,n),n+=i.byteLength;return r}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const s=new DataView(new ArrayBuffer(3));return s.setUint8(0,3),s.setInt16(1,e.value,!1),new Uint8Array(s.buffer);case"integer":const r=new DataView(new ArrayBuffer(5));return r.setUint8(0,4),r.setInt32(1,e.value,!1),new Uint8Array(r.buffer);case"long":const n=new Uint8Array(9);return n[0]=5,n.set(e.value.bytes,1),n;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(i.buffer);return o.set(e.value,3),o;case"string":const a=this.fromUtf8(e.value),c=new DataView(new ArrayBuffer(3+a.byteLength));c.setUint8(0,7),c.setUint16(1,a.byteLength,!1);const u=new Uint8Array(c.buffer);return u.set(a,3),u;case"timestamp":const d=new Uint8Array(9);return d[0]=8,d.set(De.fromNumber(e.value.valueOf()).bytes,1),d;case"uuid":if(!Nc.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const l=new Uint8Array(17);return l[0]=9,l.set(gr(e.value.replace(/\-/g,"")),1),l}}parse(e){const s={};let r=0;for(;r<e.byteLength;){const n=e.getUint8(r++),i=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+r,n));switch(r+=n,e.getUint8(r++)){case 0:s[i]={type:Ps,value:!0};break;case 1:s[i]={type:Ps,value:!1};break;case 2:s[i]={type:Dc,value:e.getInt8(r++)};break;case 3:s[i]={type:Tc,value:e.getInt16(r,!1)},r+=2;break;case 4:s[i]={type:Bc,value:e.getInt32(r,!1)},r+=4;break;case 5:s[i]={type:Ic,value:new De(new Uint8Array(e.buffer,e.byteOffset+r,8))},r+=8;break;case 6:const o=e.getUint16(r,!1);r+=2,s[i]={type:Mc,value:new Uint8Array(e.buffer,e.byteOffset+r,o)},r+=o;break;case 7:const a=e.getUint16(r,!1);r+=2,s[i]={type:Pc,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+r,a))},r+=a;break;case 8:s[i]={type:Oc,value:new Date(new De(new Uint8Array(e.buffer,e.byteOffset+r,8)).valueOf())},r+=8;break;case 9:const c=new Uint8Array(e.buffer,e.byteOffset+r,16);r+=16,s[i]={type:Fc,value:`${z(c.subarray(0,4))}-${z(c.subarray(4,6))}-${z(c.subarray(6,8))}-${z(c.subarray(8,10))}-${z(c.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return s}}var Ms;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(Ms||(Ms={}));const Ps="boolean",Dc="byte",Tc="short",Bc="integer",Ic="long",Mc="binary",Pc="string",Oc="timestamp",Fc="uuid",Nc=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,Pr=4,se=Pr*2,ue=4,$c=se+ue*2;function Lc({byteLength:t,byteOffset:e,buffer:s}){if(t<$c)throw new Error("Provided message too short to accommodate event stream message overhead");const r=new DataView(s,e,t),n=r.getUint32(0,!1);if(t!==n)throw new Error("Reported message length does not match received message length");const i=r.getUint32(Pr,!1),o=r.getUint32(se,!1),a=r.getUint32(t-ue,!1),c=new Mr().update(new Uint8Array(s,e,se));if(o!==c.digest())throw new Error(`The prelude checksum specified in the message (${o}) does not match the calculated CRC32 checksum (${c.digest()})`);if(c.update(new Uint8Array(s,e+se,t-(se+ue))),a!==c.digest())throw new Error(`The message checksum (${c.digest()}) did not match the expected value of ${a}`);return{headers:new DataView(s,e+se+ue,i),body:new Uint8Array(s,e+se+ue+i,n-i-(se+ue+ue))}}class Uc{constructor(e,s){this.headerMarshaller=new kc(e,s),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){const e=this.messageBuffer.pop(),s=this.isEndOfStream;return{getMessage(){return e},isEndOfStream(){return s}}}getAvailableMessages(){const e=this.messageBuffer;this.messageBuffer=[];const s=this.isEndOfStream;return{getMessages(){return e},isEndOfStream(){return s}}}encode({headers:e,body:s}){const r=this.headerMarshaller.format(e),n=r.byteLength+s.byteLength+16,i=new Uint8Array(n),o=new DataView(i.buffer,i.byteOffset,i.byteLength),a=new Mr;return o.setUint32(0,n,!1),o.setUint32(4,r.byteLength,!1),o.setUint32(8,a.update(i.subarray(0,8)).digest(),!1),i.set(r,12),i.set(s,r.byteLength+12),o.setUint32(n-4,a.update(i.subarray(8,n-4)).digest(),!1),i}decode(e){const{headers:s,body:r}=Lc(e);return{headers:this.headerMarshaller.parse(s),body:r}}formatHeaders(e){return this.headerMarshaller.format(e)}}class Hc{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.decoder.decode(e)}}class zc{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream)yield this.options.encoder.encode(e);this.options.includeEndFrame&&(yield new Uint8Array(0))}}class qc{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const s=await this.options.deserializer(e);s!==void 0&&(yield s)}}}class jc{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.serializer(e)}}function Kc(t){let e=0,s=0,r=null,n=null;const i=a=>{if(typeof a!="number")throw new Error("Attempted to allocate an event message where size was not a number: "+a);e=a,s=4,r=new Uint8Array(a),new DataView(r.buffer).setUint32(0,a,!1)},o=async function*(){const a=t[Symbol.asyncIterator]();for(;;){const{value:c,done:u}=await a.next();if(u){if(e)if(e===s)yield r;else throw new Error("Truncated event message received.");else return;return}const d=c.length;let l=0;for(;l<d;){if(!r){const f=d-l;n||(n=new Uint8Array(4));const m=Math.min(4-s,f);if(n.set(c.slice(l,l+m),s),s+=m,l+=m,s<4)break;i(new DataView(n.buffer).getUint32(0,!1)),n=null}const h=Math.min(e-s,d-l);r.set(c.slice(l,l+h),s),s+=h,l+=h,e&&e===s&&(yield r,r=null,e=0,s=0)}}};return{[Symbol.asyncIterator]:o}}function Wc(t,e){return async function(s){const{value:r}=s.headers[":message-type"];if(r==="error"){const n=new Error(s.headers[":error-message"].value||"UnknownError");throw n.name=s.headers[":error-code"].value,n}else if(r==="exception"){const n=s.headers[":exception-type"].value,i={[n]:s},o=await t(i);if(o.$unknown){const a=new Error(e(s.body));throw a.name=n,a}throw o[n]}else if(r==="event"){const n={[s.headers[":event-type"].value]:s},i=await t(n);return i.$unknown?void 0:i}else throw Error(`Unrecognizable event type: ${s.headers[":event-type"].value}`)}}let Gc=class{constructor({utf8Encoder:e,utf8Decoder:s}){this.eventStreamCodec=new Uc(e,s),this.utfEncoder=e}deserialize(e,s){const r=Kc(e);return new qc({messageStream:new Hc({inputStream:r,decoder:this.eventStreamCodec}),deserializer:Wc(s,this.utfEncoder)})}serialize(e,s){return new zc({messageStream:new jc({inputStream:e,serializer:s}),encoder:this.eventStreamCodec,includeEndFrame:!0})}};const Vc=t=>({[Symbol.asyncIterator]:async function*(){const e=t.getReader();try{for(;;){const{done:s,value:r}=await e.read();if(s)return;yield r}}finally{e.releaseLock()}}}),Qc=t=>{const e=t[Symbol.asyncIterator]();return new ReadableStream({async pull(s){const{done:r,value:n}=await e.next();if(r)return s.close();s.enqueue(n)}})};class Xc{constructor({utf8Encoder:e,utf8Decoder:s}){this.universalMarshaller=new Gc({utf8Decoder:s,utf8Encoder:e})}deserialize(e,s){const r=Jc(e)?Vc(e):e;return this.universalMarshaller.deserialize(r,s)}serialize(e,s){const r=this.universalMarshaller.serialize(e,s);return typeof ReadableStream=="function"?Qc(r):r}}const Jc=t=>typeof ReadableStream=="function"&&t instanceof ReadableStream,Zc=t=>new Xc(t),Yc=t=>()=>Promise.reject(t),Os=typeof TextEncoder=="function"?new TextEncoder:null,eu=t=>{if(typeof t=="string"){if(Os)return Os.encode(t).byteLength;let e=t.length;for(let s=e-1;s>=0;s--){const r=t.charCodeAt(s);r>127&&r<=2047?e++:r>2047&&r<=65535&&(e+=2),r>=56320&&r<=57343&&s--}return e}else{if(typeof t.byteLength=="number")return t.byteLength;if(typeof t.size=="number")return t.size}throw new Error(`Body Length computation failed for ${t}`)},Or="required",y="type",E="rules",x="conditions",b="fn",S="argv",C="ref",Te="assign",Q="url",X="properties",J="headers",tu=!0,pe="isSet",le="stringEquals",pt="aws.parseArn",de="arn",U="booleanEquals",H="endpoint",A="tree",R="error",ge={[Or]:!1,[y]:"String"},Fs={[Or]:!0,default:!1,[y]:"Boolean"},ft={[b]:"not",[S]:[{[b]:pe,[S]:[{[C]:"Endpoint"}]}]},Fr={[C]:"Endpoint"},Ue={[b]:pe,[S]:[{[C]:"Region"}]},He={[b]:"aws.partition",[S]:[{[C]:"Region"}],[Te]:"PartitionResult"},mt={[b]:"not",[S]:[{[b]:le,[S]:[{[b]:"getAttr",[S]:[{[C]:"PartitionResult"},"name"]},"aws-iso"]}]},Lt={[b]:"getAttr",[S]:[{[C]:"PartitionResult"},"name"]},gt={[b]:"not",[S]:[{[b]:le,[S]:[Lt,"aws-iso-b"]}]},Je={[b]:"getAttr",[S]:[{[C]:"PartitionResult"},"supportsFIPS"]},K={},Nr={[R]:"FIPS is enabled but this partition does not support FIPS",[y]:R},$r={[R]:"DualStack is enabled but this partition does not support DualStack",[y]:R},yt={[R]:"Invalid ARN: Failed to parse ARN.",[y]:R},Ns={[b]:U,[S]:[!0,{[b]:"getAttr",[S]:[{[C]:"PartitionResult"},"supportsDualStack"]}]},$s=[{[C]:"StreamARN"}],su=[{[b]:pe,[S]:[Fr]}],wt=[{[x]:[{[b]:"isValidHostLabel",[S]:[{[b]:"getAttr",[S]:[{[C]:de},"accountId"]},!1]}],[E]:[{[x]:[{[b]:"isValidHostLabel",[S]:[{[b]:"getAttr",[S]:[{[C]:de},"region"]},!1]}],[E]:[{[x]:[{[b]:le,[S]:[{[b]:"getAttr",[S]:[{[C]:de},"service"]},"kinesis"]}],[E]:[{[x]:[{[b]:"getAttr",[S]:[{[C]:de},"resourceId[0]"],[Te]:"arnType"},{[b]:"not",[S]:[{[b]:le,[S]:[{[C]:"arnType"},""]}]}],[E]:[{[x]:[{[b]:le,[S]:[{[C]:"arnType"},"stream"]}],[E]:[{[x]:[{[b]:le,[S]:[Lt,"{arn#partition}"]}],[E]:[{[x]:[{[b]:pe,[S]:[{[C]:"OperationType"}]}],[E]:[{[x]:[{[b]:U,[S]:[{[C]:"UseFIPS"},!0]},{[b]:U,[S]:[{[C]:"UseDualStack"},!0]}],[E]:[{[x]:[{[b]:U,[S]:[Je,!0]}],[E]:[{[x]:[{[b]:U,[S]:[{[b]:"getAttr",[S]:[{[C]:"PartitionResult"},"supportsDualStack"]},!0]}],[E]:[{[H]:{[Q]:"https://{arn#accountId}.{OperationType}-kinesis-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",[X]:{},[J]:{}},[y]:H}],[y]:A},{[R]:"DualStack is enabled, but this partition does not support DualStack.",[y]:R}],[y]:A},{[R]:"FIPS is enabled, but this partition does not support FIPS.",[y]:R}],[y]:A},{[x]:[{[b]:U,[S]:[{[C]:"UseFIPS"},!0]}],[E]:[{[x]:[{[b]:U,[S]:[Je,!0]}],[E]:[{[H]:{[Q]:"https://{arn#accountId}.{OperationType}-kinesis-fips.{Region}.{PartitionResult#dnsSuffix}",[X]:{},[J]:{}},[y]:H}],[y]:A},Nr],[y]:A},{[x]:[{[b]:U,[S]:[{[C]:"UseDualStack"},!0]}],[E]:[{[x]:[{[b]:U,[S]:[{[b]:"getAttr",[S]:[{[C]:"PartitionResult"},"supportsDualStack"]},!0]}],[E]:[{[H]:{[Q]:"https://{arn#accountId}.{OperationType}-kinesis.{Region}.{PartitionResult#dualStackDnsSuffix}",[X]:{},[J]:{}},[y]:H}],[y]:A},$r],[y]:A},{[H]:{[Q]:"https://{arn#accountId}.{OperationType}-kinesis.{Region}.{PartitionResult#dnsSuffix}",[X]:{},[J]:{}},[y]:H}],[y]:A},{[R]:"Operation Type is not set. Please contact service team for resolution.",[y]:R}],[y]:A},{[R]:"Partition: {arn#partition} from ARN doesn't match with partition name: {PartitionResult#name}.",[y]:R}],[y]:A},{[R]:"Invalid ARN: Kinesis ARNs don't support `{arnType}` arn types.",[y]:R}],[y]:A},{[R]:"Invalid ARN: No ARN type specified",[y]:R}],[y]:A},{[R]:"Invalid ARN: The ARN was not for the Kinesis service, found: {arn#service}.",[y]:R}],[y]:A},{[R]:"Invalid ARN: Invalid region.",[y]:R}],[y]:A},{[R]:"Invalid ARN: Invalid account id.",[y]:R}],ru=[{[b]:U,[S]:[{[C]:"UseFIPS"},!0]},{[b]:U,[S]:[{[C]:"UseDualStack"},!0]}],nu=[{[b]:U,[S]:[Je,!0]}],Ls=[{[b]:U,[S]:[{[C]:"UseFIPS"},!0]}],Us=[{[b]:U,[S]:[{[C]:"UseDualStack"},!0]}],Hs=[{[C]:"ConsumerARN"}],zs=[{[C]:"ResourceARN"}],iu={version:"1.0",parameters:{Region:ge,UseDualStack:Fs,UseFIPS:Fs,Endpoint:ge,StreamARN:ge,OperationType:ge,ConsumerARN:ge,ResourceARN:ge},[E]:[{[x]:[{[b]:pe,[S]:$s},ft,Ue,He,mt,gt],[E]:[{[x]:[{[b]:pt,[S]:$s,[Te]:de}],[E]:wt,[y]:A},yt],[y]:A},{[x]:[{[b]:pe,[S]:Hs},ft,Ue,He,mt,gt],[E]:[{[x]:[{[b]:pt,[S]:Hs,[Te]:de}],[E]:wt,[y]:A},yt],[y]:A},{[x]:[{[b]:pe,[S]:zs},ft,Ue,He,mt,gt],[E]:[{[x]:[{[b]:pt,[S]:zs,[Te]:de}],[E]:wt,[y]:A},yt],[y]:A},{[x]:su,[E]:[{[x]:Ls,error:"Invalid Configuration: FIPS and custom endpoint are not supported",[y]:R},{[x]:Us,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",[y]:R},{endpoint:{[Q]:Fr,[X]:K,[J]:K},[y]:H}],[y]:A},{[x]:[Ue],[E]:[{[x]:[He],[E]:[{[x]:ru,[E]:[{[x]:[{[b]:U,[S]:[tu,Je]},Ns],[E]:[{endpoint:{[Q]:"https://kinesis-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",[X]:K,[J]:K},[y]:H}],[y]:A},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",[y]:R}],[y]:A},{[x]:Ls,[E]:[{[x]:nu,[E]:[{[x]:[{[b]:le,[S]:[Lt,"aws-us-gov"]}],endpoint:{[Q]:"https://kinesis.{Region}.amazonaws.com",[X]:K,[J]:K},[y]:H},{endpoint:{[Q]:"https://kinesis-fips.{Region}.{PartitionResult#dnsSuffix}",[X]:K,[J]:K},[y]:H}],[y]:A},Nr],[y]:A},{[x]:Us,[E]:[{[x]:[Ns],[E]:[{endpoint:{[Q]:"https://kinesis.{Region}.{PartitionResult#dualStackDnsSuffix}",[X]:K,[J]:K},[y]:H}],[y]:A},$r],[y]:A},{endpoint:{[Q]:"https://kinesis.{Region}.{PartitionResult#dnsSuffix}",[X]:K,[J]:K},[y]:H}],[y]:A}],[y]:A},{error:"Invalid Configuration: Missing Region",[y]:R}]},ou=iu,au=(t,e={})=>Qn(ou,{endpointParams:t,logger:e.logger});Ge.aws=nr;const cu=t=>({apiVersion:"2013-12-02",base64Decoder:(t==null?void 0:t.base64Decoder)??Ft,base64Encoder:(t==null?void 0:t.base64Encoder)??fr,disableHostPrefix:(t==null?void 0:t.disableHostPrefix)??!1,endpointProvider:(t==null?void 0:t.endpointProvider)??au,extensions:(t==null?void 0:t.extensions)??[],httpAuthSchemeProvider:(t==null?void 0:t.httpAuthSchemeProvider)??Ba,httpAuthSchemes:(t==null?void 0:t.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new Zo}],logger:(t==null?void 0:t.logger)??new hr,serviceId:(t==null?void 0:t.serviceId)??"Kinesis",urlParser:(t==null?void 0:t.urlParser)??Ve,utf8Decoder:(t==null?void 0:t.utf8Decoder)??be,utf8Encoder:(t==null?void 0:t.utf8Encoder)??pr}),uu=["in-region","cross-region","mobile","standard","legacy"],lu=({defaultsMode:t}={})=>Yo(async()=>{const e=typeof t=="function"?await t():t;switch(e==null?void 0:e.toLowerCase()){case"auto":return Promise.resolve(du()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e==null?void 0:e.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${uu.join(", ")}, got ${e}`)}}),du=()=>{var s,r;const t=typeof window<"u"&&((s=window==null?void 0:window.navigator)!=null&&s.userAgent)?Ir.parse(window.navigator.userAgent):void 0,e=(r=t==null?void 0:t.platform)==null?void 0:r.type;return e==="tablet"||e==="mobile"},hu=t=>{const e=lu(t),s=()=>e().then(xo),r=cu(t);return{...r,...t,runtime:"browser",defaultsMode:e,bodyLengthChecker:(t==null?void 0:t.bodyLengthChecker)??eu,credentialDefaultProvider:(t==null?void 0:t.credentialDefaultProvider)??(n=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(t==null?void 0:t.defaultUserAgentProvider)??Rc({serviceId:r.serviceId,clientVersion:Ya.version}),eventStreamSerdeProvider:(t==null?void 0:t.eventStreamSerdeProvider)??Zc,maxAttempts:(t==null?void 0:t.maxAttempts)??Qe,region:(t==null?void 0:t.region)??Yc("Region is missing"),requestHandler:Nt.create((t==null?void 0:t.requestHandler)??s),retryMode:(t==null?void 0:t.retryMode)??(async()=>(await s()).retryMode||Fi),sha256:(t==null?void 0:t.sha256)??bc,streamCollector:(t==null?void 0:t.streamCollector)??po,useDualstackEndpoint:(t==null?void 0:t.useDualstackEndpoint)??(()=>Promise.resolve(ci)),useFipsEndpoint:(t==null?void 0:t.useFipsEndpoint)??(()=>Promise.resolve(ui))}},pu=t=>{let e=async()=>{if(t.region===void 0)throw new Error("Region is missing from runtimeConfig");const s=t.region;return typeof s=="string"?s:s()};return{setRegion(s){e=s},region(){return e}}},fu=t=>({region:t.region()}),mu=t=>{const e=t.httpAuthSchemes;let s=t.httpAuthSchemeProvider,r=t.credentials;return{setHttpAuthScheme(n){const i=e.findIndex(o=>o.schemeId===n.schemeId);i===-1?e.push(n):e.splice(i,1,n)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(n){s=n},httpAuthSchemeProvider(){return s},setCredentials(n){r=n},credentials(){return r}}},gu=t=>({httpAuthSchemes:t.httpAuthSchemes(),httpAuthSchemeProvider:t.httpAuthSchemeProvider(),credentials:t.credentials()}),ze=t=>t,yu=(t,e)=>{const s={...ze(pu(t)),...ze(_o(t)),...ze(gn(t)),...ze(mu(t))};return e.forEach(r=>r.configure(s)),{...t,...fu(s),...ko(s),...yn(s),...gu(s)}};class wu extends io{constructor(...[e]){const s=hu(e||{}),r=Ma(s),n=Tn(r),i=no(n),o=li(i),a=o,c=Ti(a),u=Wo(c),d=Ia(u),l=yu(d,(e==null?void 0:e.extensions)||[]);super(l),this.config=l,this.middlewareStack.use(ai(this.config)),this.middlewareStack.use(No(this.config)),this.middlewareStack.use(Qo(this.config)),this.middlewareStack.use(vn(this.config)),this.middlewareStack.use(An(this.config)),this.middlewareStack.use(Dn(this.config)),this.middlewareStack.use(Ii(this.config,{httpAuthSchemeParametersProvider:Da,identityProviderConfigProvider:async h=>new Ho({"aws.auth#sigv4":h.credentials})})),this.middlewareStack.use(Uo(this.config))}destroy(){super.destroy()}}class P extends $t{constructor(e){super(e),Object.setPrototypeOf(this,P.prototype)}}class Ut extends P{constructor(e){super({name:"AccessDeniedException",$fault:"client",...e}),this.name="AccessDeniedException",this.$fault="client",Object.setPrototypeOf(this,Ut.prototype)}}class Ht extends P{constructor(e){super({name:"InvalidArgumentException",$fault:"client",...e}),this.name="InvalidArgumentException",this.$fault="client",Object.setPrototypeOf(this,Ht.prototype)}}class zt extends P{constructor(e){super({name:"LimitExceededException",$fault:"client",...e}),this.name="LimitExceededException",this.$fault="client",Object.setPrototypeOf(this,zt.prototype)}}class qt extends P{constructor(e){super({name:"ResourceInUseException",$fault:"client",...e}),this.name="ResourceInUseException",this.$fault="client",Object.setPrototypeOf(this,qt.prototype)}}class jt extends P{constructor(e){super({name:"ResourceNotFoundException",$fault:"client",...e}),this.name="ResourceNotFoundException",this.$fault="client",Object.setPrototypeOf(this,jt.prototype)}}class Kt extends P{constructor(e){super({name:"ExpiredIteratorException",$fault:"client",...e}),this.name="ExpiredIteratorException",this.$fault="client",Object.setPrototypeOf(this,Kt.prototype)}}class Wt extends P{constructor(e){super({name:"ExpiredNextTokenException",$fault:"client",...e}),this.name="ExpiredNextTokenException",this.$fault="client",Object.setPrototypeOf(this,Wt.prototype)}}class Gt extends P{constructor(e){super({name:"KMSAccessDeniedException",$fault:"client",...e}),this.name="KMSAccessDeniedException",this.$fault="client",Object.setPrototypeOf(this,Gt.prototype)}}class Vt extends P{constructor(e){super({name:"KMSDisabledException",$fault:"client",...e}),this.name="KMSDisabledException",this.$fault="client",Object.setPrototypeOf(this,Vt.prototype)}}class Qt extends P{constructor(e){super({name:"KMSInvalidStateException",$fault:"client",...e}),this.name="KMSInvalidStateException",this.$fault="client",Object.setPrototypeOf(this,Qt.prototype)}}class Xt extends P{constructor(e){super({name:"KMSNotFoundException",$fault:"client",...e}),this.name="KMSNotFoundException",this.$fault="client",Object.setPrototypeOf(this,Xt.prototype)}}class Jt extends P{constructor(e){super({name:"KMSOptInRequired",$fault:"client",...e}),this.name="KMSOptInRequired",this.$fault="client",Object.setPrototypeOf(this,Jt.prototype)}}class Zt extends P{constructor(e){super({name:"KMSThrottlingException",$fault:"client",...e}),this.name="KMSThrottlingException",this.$fault="client",Object.setPrototypeOf(this,Zt.prototype)}}class Yt extends P{constructor(e){super({name:"ProvisionedThroughputExceededException",$fault:"client",...e}),this.name="ProvisionedThroughputExceededException",this.$fault="client",Object.setPrototypeOf(this,Yt.prototype)}}class es extends P{constructor(e){super({name:"ValidationException",$fault:"client",...e}),this.name="ValidationException",this.$fault="client",Object.setPrototypeOf(this,es.prototype)}}var qs;(function(t){t.visit=(e,s)=>e.SubscribeToShardEvent!==void 0?s.SubscribeToShardEvent(e.SubscribeToShardEvent):e.ResourceNotFoundException!==void 0?s.ResourceNotFoundException(e.ResourceNotFoundException):e.ResourceInUseException!==void 0?s.ResourceInUseException(e.ResourceInUseException):e.KMSDisabledException!==void 0?s.KMSDisabledException(e.KMSDisabledException):e.KMSInvalidStateException!==void 0?s.KMSInvalidStateException(e.KMSInvalidStateException):e.KMSAccessDeniedException!==void 0?s.KMSAccessDeniedException(e.KMSAccessDeniedException):e.KMSNotFoundException!==void 0?s.KMSNotFoundException(e.KMSNotFoundException):e.KMSOptInRequired!==void 0?s.KMSOptInRequired(e.KMSOptInRequired):e.KMSThrottlingException!==void 0?s.KMSThrottlingException(e.KMSThrottlingException):e.InternalFailureException!==void 0?s.InternalFailureException(e.InternalFailureException):s._(e.$unknown[0],e.$unknown[1])})(qs||(qs={}));const bu=async(t,e)=>{const s=zu("PutRecords");let r;return r=JSON.stringify(Nu(t,e)),Hu(e,s,"/",void 0,r)},Su=async(t,e)=>{if(t.statusCode>=300)return vu(t,e);const s=await Dr(t.body,e);let r={};return r=M(s),{$metadata:$(t),...r}},vu=async(t,e)=>{const s={...t,body:await _a(t.body,e)},r=ka(t,s.body);switch(r){case"AccessDeniedException":case"com.amazonaws.kinesis#AccessDeniedException":throw await xu(s);case"InvalidArgumentException":case"com.amazonaws.kinesis#InvalidArgumentException":throw await Ru(s);case"LimitExceededException":case"com.amazonaws.kinesis#LimitExceededException":throw await Iu(s);case"ResourceInUseException":case"com.amazonaws.kinesis#ResourceInUseException":throw await Pu(s);case"ResourceNotFoundException":case"com.amazonaws.kinesis#ResourceNotFoundException":throw await Ou(s);case"ExpiredIteratorException":case"com.amazonaws.kinesis#ExpiredIteratorException":throw await Eu(s);case"KMSAccessDeniedException":case"com.amazonaws.kinesis#KMSAccessDeniedException":throw await Cu(s);case"KMSDisabledException":case"com.amazonaws.kinesis#KMSDisabledException":throw await _u(s);case"KMSInvalidStateException":case"com.amazonaws.kinesis#KMSInvalidStateException":throw await ku(s);case"KMSNotFoundException":case"com.amazonaws.kinesis#KMSNotFoundException":throw await Du(s);case"KMSOptInRequired":case"com.amazonaws.kinesis#KMSOptInRequired":throw await Tu(s);case"KMSThrottlingException":case"com.amazonaws.kinesis#KMSThrottlingException":throw await Bu(s);case"ProvisionedThroughputExceededException":case"com.amazonaws.kinesis#ProvisionedThroughputExceededException":throw await Mu(s);case"ExpiredNextTokenException":case"com.amazonaws.kinesis#ExpiredNextTokenException":throw await Au(s);case"ValidationException":case"com.amazonaws.kinesis#ValidationException":throw await Fu(s);default:const n=s.body;return Uu({output:t,parsedBody:n,errorCode:r})}},xu=async(t,e)=>{const s=t.body,r=M(s),n=new Ut({$metadata:$(t),...r});return N(n,s)},Eu=async(t,e)=>{const s=t.body,r=M(s),n=new Kt({$metadata:$(t),...r});return N(n,s)},Au=async(t,e)=>{const s=t.body,r=M(s),n=new Wt({$metadata:$(t),...r});return N(n,s)},Ru=async(t,e)=>{const s=t.body,r=M(s),n=new Ht({$metadata:$(t),...r});return N(n,s)},Cu=async(t,e)=>{const s=t.body,r=M(s),n=new Gt({$metadata:$(t),...r});return N(n,s)},_u=async(t,e)=>{const s=t.body,r=M(s),n=new Vt({$metadata:$(t),...r});return N(n,s)},ku=async(t,e)=>{const s=t.body,r=M(s),n=new Qt({$metadata:$(t),...r});return N(n,s)},Du=async(t,e)=>{const s=t.body,r=M(s),n=new Xt({$metadata:$(t),...r});return N(n,s)},Tu=async(t,e)=>{const s=t.body,r=M(s),n=new Jt({$metadata:$(t),...r});return N(n,s)},Bu=async(t,e)=>{const s=t.body,r=M(s),n=new Zt({$metadata:$(t),...r});return N(n,s)},Iu=async(t,e)=>{const s=t.body,r=M(s),n=new zt({$metadata:$(t),...r});return N(n,s)},Mu=async(t,e)=>{const s=t.body,r=M(s),n=new Yt({$metadata:$(t),...r});return N(n,s)},Pu=async(t,e)=>{const s=t.body,r=M(s),n=new qt({$metadata:$(t),...r});return N(n,s)},Ou=async(t,e)=>{const s=t.body,r=M(s),n=new jt({$metadata:$(t),...r});return N(n,s)},Fu=async(t,e)=>{const s=t.body,r=M(s),n=new es({$metadata:$(t),...r});return N(n,s)},Nu=(t,e)=>wr(t,{Records:s=>Lu(s,e),StreamARN:[],StreamName:[]}),$u=(t,e)=>wr(t,{Data:e.base64Encoder,ExplicitHashKey:[],PartitionKey:[]}),Lu=(t,e)=>t.filter(s=>s!=null).map(s=>$u(s,e)),$=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),Uu=So(P),Hu=async(t,e,s,r,n)=>{const{hostname:i,protocol:o="https",port:a,path:c}=await t.endpoint(),u={protocol:o,hostname:i,port:a,method:"POST",path:c.endsWith("/")?c.slice(0,-1)+s:c+s,headers:e};return n!==void 0&&(u.body=n),new q(u)};function zu(t){return{"content-type":"application/x-amz-json-1.1","x-amz-target":`Kinesis_20131202.${t}`}}class qu extends yr.classBuilder().ep({...Pa,OperationType:{type:"staticContextParams",value:"data"},StreamARN:{type:"contextParams",name:"StreamARN"}}).m(function(e,s,r,n){return[ki(r,this.serialize,this.deserialize),Di(r,e.getEndpointParameterInstructions())]}).s("Kinesis_20131202","PutRecords",{}).n("KinesisClient","PutRecordsCommand").f(void 0,void 0).ser(bu).de(Su).build(){}const Re=Dt.UAParser();class ju extends Tt{constructor(s,r,n,i,o,a,c,u,d,l){super(s);me(this,"kinesisClient");this.analyticsStorage=r,this.analyticsService=n,this.globalStateService=i,this.userService=o,this.i18nService=a,this.fetchService=c,this.appService=u,this.connectionService=d,this.notificationService=l,this.kinesisClient=new wu({region:dn,credentials:{accessKeyId:fn,secretAccessKey:mn}}),this.analyticsService.use(this)}get eventNumber(){return this.analyticsStorage.state.eventSequenceNumber}async boot(){await this.analyticsStorage.sync(),this.analyticsStorage.state.sessionData||(await this.incrementSessionSequenceNumber(),await this.generateSessionData()),this.analyticsStorage.state.startAppVersion||await this.setStartAppVersion(),this.analyticsStorage.state.initialIpAddress||this.setInitialIpAddress().catch(()=>{}),this.bootResolve()}async send(s){if(await this.bootPromise,!this.available)return;await this.incrementEventSequenceNumber();const r={...s,data:{...s.data,event_id:this.eventNumber,event_time_utc:Date.now()}},n=this.formatData(r);try{await this.kinesisClient.send(n)}catch{}}formatData(s){const r=this.getUserProperties(),n=this.getGeneralProperties(),i={...r,...n,...s.data,event_name:s.name},a={Data:new TextEncoder().encode(JSON.stringify(i)),PartitionKey:hn};return new qu({Records:[a],StreamName:pn})}getUserProperties(){const s=this.connectionService.useAutoConnect?"on":"off",r=this.appService.isBlockAds?"on":"off",n=this.notificationService.permition==="allowed"?"on":"off",i={user_properties__autoconnect_app:s,user_properties__adblock:r,user_properties__webrtc:"default",user_properties__stop_trackers:"default",user_properties__block_traking_socials:"default",user_properties__block_push_cookies:"default",user_properties__malware_evader:"default",user_properties__remove_utm_parameters:"default",user_properties__remove_fbclid:"default",user_properties__remove_gclid:"default",user_properties__location_warp:"default",user_properties__time_warp:"default",user_properties__language_warp:"default",user_properties__plan:"default",user_properties__desktop_notifications:n,user_properties__smart_location:"default",user_properties__exclude_websites:"default",user_properties__custom_proxy:"default",user_properties__mask_user_agent:"default",user_properties__debug_logging:"default"};return this.userService.subscription&&(i.user_properties__plan=this.userService.subscription.name),i}getGeneralProperties(){var l,h,f,m,w,g;const s=B.runtime.getManifest(),r=((l=new Date().toString().match(/([-+][0-9]+)\s/))==null?void 0:l[1])??"",{timeZone:n}=Intl.DateTimeFormat().resolvedOptions(),i=this.analyticsStorage.state.sessionSequenceNumber===1?1:0,o=Re.browser.name??"Chrome",a=Re.browser.version??"0.0.0",c=()=>this.appService.colorTheme==="dark"?"dark":this.appService.colorTheme==="light"?"light":"default",{experiment:u}=this.analyticsService;return{user_id:((h=this.userService.user)==null?void 0:h.id)??"",device_id:this.globalStateService.udid.value,time_offset:r,time_zone:n,session_number:this.analyticsStorage.state.sessionSequenceNumber,session_id:((f=this.analyticsStorage.state.sessionData)==null?void 0:f.id)??"",session_started:((m=this.analyticsStorage.state.sessionData)==null?void 0:m.startedAt)??"",is_first_session:i,app_version:s.version,start_app_version:this.analyticsStorage.state.startAppVersion??"",platform:"extension",device_category:Re.device.type??"desktop",os_name:Re.os.name??"",os_version:Re.os.version??"",screen_width:String(this.globalStateService.deviceScreen.width),screen_height:String(this.globalStateService.deviceScreen.height),browser_group:o,browser_name:`${o} ${a}`,browser_user_agent:navigator.userAgent,app_language:this.i18nService.activeLocale,ip_address:this.analyticsStorage.state.initialIpAddress??"",country:((w=this.appService.geolocation)==null?void 0:w.country)??"",region:((g=this.appService.geolocation)==null?void 0:g.region)??"",event_source:"extension",user_properties__exp_id:(u==null?void 0:u.slug)??"",user_properties__exp_var:(u==null?void 0:u.group.toString())??"",user_properties__install_date:this.globalStateService.appInstallationDate,user_properties__theme:c()}}async incrementEventSequenceNumber(){await this.analyticsStorage.setItems({eventSequenceNumber:this.eventNumber+1})}async incrementSessionSequenceNumber(){const s=this.analyticsStorage.state.sessionSequenceNumber;await this.analyticsStorage.setItems({sessionSequenceNumber:s+1})}async generateSessionData(){await this.analyticsStorage.setItems({sessionData:{id:Vs(),startedAt:Date.now()}})}async setStartAppVersion(){const s=B.runtime.getManifest();await this.analyticsStorage.setItems({startAppVersion:s.version})}async setInitialIpAddress(){const s=await this.fetchService.request({method:"GET",url:an});if(s.success)try{const r=s.data.trim().split(/\n/).map(i=>i.split("=")),n=Object.fromEntries(r);await this.analyticsStorage.setItems({initialIpAddress:n.ip})}catch{}}}const Ku=new Bt("aws-kinesis",ln),Wu=new ju("aws-kinesis",Ku,Z,G,xe,ve,et,Se,Pe,fe),Gu="349c341094927d0c67a38a15e4cfbfdc",Vu="https://api2.amplitude.com/2/httpapi";class Qu extends Tt{constructor(e,s,r,n,i,o,a,c,u){super(e),this.analyticsService=s,this.globalStateService=r,this.fetchService=n,this.userService=i,this.i18nService=o,this.appService=a,this.connectionService=c,this.notificationService=u,this.analyticsService.use(this)}async boot(){await Promise.resolve(this),this.bootResolve()}async send(e){if(await this.bootPromise,!this.available||!this.userService.user)return;const s=this.formatData(e);await this.fetchService.request({url:Vu,method:"POST",body:{api_key:Gu,events:[s]}})}formatData(e){const s=B.runtime.getManifest(),r=this.getUserProperties();return{app_version:s.version,event_type:e.name,event_properties:{...e.data},user_id:this.globalStateService.udid.value,user_properties:{...r}}}getUserProperties(){const e=this.userService.user?"authorized":"non-authorized",s=this.notificationService.permition==="allowed"?"on":"off",r=()=>this.appService.colorTheme==="dark"?"on":this.appService.colorTheme==="light"?"off":"default",n=this.connectionService.useAutoConnect?"on":"off",i={user_type:this.userService.userType,user_auth_status:e,desktop_notifications:s,dark_mode:r(),block_webrtc_detection:"default",adblock:"default",stop_trackers:"default",block_tracking_social:"default",block_push_use_coockies:"default",malware_evader:"default",remove_utm_parameters:"default",remove_fbclid_parameters:"default",remove_gclid_parameters:"default",location_warp:"default",time_warp:"default",language_warp:"default",auto_connect:n,smart_location:"default",exclude_websites:"default",custom_proxy:"default",mask_user_agent:"default",debug_logging:"default",language:this.i18nService.activeLocale,plan:"free"};return this.userService.subscription&&(i.plan=this.userService.subscription.name),i}}const Xu=new Qu("amplitude",Z,G,et,xe,ve,Se,Pe,fe);var Ze=(t=>(t[t.not_active=0]="not_active",t[t.control=1]="control",t[t.test=2]="test",t))(Ze||{});const Ju=F.object({group:F.nativeEnum(Ze),experiment_name:F.string(),experiment_slug:F.string()}),Zu=F.object({config:Ju.optional().describe(re.session),activeExperimentSlug:F.string().describe(re.persist)}).default({activeExperimentSlug:""}),Yu=new kt(Zu),el="https://split-tool.com/api/application-experiment/group/",tl="e9efc93ef559ff3064712c2a3399aff66eb8",bt="https://veepn.com/",St="veepn-ab-tests";class sl extends zr{constructor(s,r,n,i){super();me(this,"experimentSlug","abtest_chrome_adblock");this.testStorage=s,this.globalStateService=r,this.fetchService=n,this.analyticsService=i}get config(){return this.testStorage.state.config??null}get fetureAvailable(){if(!this.testStorage.state.config)return!1;const{group:s,experiment_slug:r}=this.testStorage.state.config;return r===this.experimentSlug&&s===Ze.test}async boot(){await this.testStorage.sync(),this.testStorage.state.activeExperimentSlug===this.experimentSlug&&!this.testStorage.state.config&&await this.fetchConfig(),this.bootResolve(),await this.bootPromise}async allowTestInitialisation(){await this.testStorage.setItems({activeExperimentSlug:this.experimentSlug})}async fetchConfig(){const s={bundle_id:tl,udid:this.globalStateService.udid.value,experiment_name:this.experimentSlug,language:"en"},r=await this.fetchService.request({url:el,method:"POST",body:s});if(r.success){await this.testStorage.setItems({config:r.data}),await this.analyticsService.setExperiment({slug:r.data.experiment_slug,group:r.data.group});const{group:n,experiment_slug:i}=r.data;n===Ze.not_active?await this.clearGroupFromCookie():typeof await this.getGroupFromCookie()>"u"&&(await this.saveGroupToCookie(n),this.analyticsService.sendEvent({type:"google-analytics",name:`${i}_group_${n}`,data:{test_name:i,user_group:n}}),this.analyticsService.sendEvent({type:"amplitude",name:`${i}_group_${n}`,data:{test_name:i,user_group:n}}),this.analyticsService.sendEvent({type:"aws-kinesis",name:"exp_group",data:{event_properties__exp_id:i,event_properties__exp_var:n.toString()}}))}}async getGroupFromCookie(){const s=new URL(bt),r=await B.cookies.get({name:St,url:s.href});if(r)try{const i=JSON.parse(r.value).find(o=>o.slug===this.experimentSlug);return i?i.group:void 0}catch{return}}async saveGroupToCookie(s){const r=new URL(bt),n=new Date;n.setFullYear(n.getFullYear()+1);const i=[{slug:this.experimentSlug,group:s}];await B.cookies.set({name:St,value:JSON.stringify(i),url:r.href,domain:`.${r.hostname}`,expirationDate:n.getTime()/1e3})}async clearGroupFromCookie(){const s=new URL(bt);await B.cookies.remove({name:St,url:s.href})}}const rl=new Bt("test",Yu),ts=new sl(rl,G,et,Z);class nl{constructor(e){this.adblockTest=e}async getAdblockData(){return await Promise.resolve(),{success:!0,data:{available:this.adblockTest.fetureAvailable}}}}class il{constructor(e,s){this.messageService=e,this.abTestsController=s}init(){this.messageService.subscribe({"get-adblock-data":this.getAdblockData.bind(this)})}async getAdblockData(){return{...await this.abTestsController.getAdblockData(),type:"get-adblock-data"}}}const ol=new nl(ts),al=new il(_t,ol);class cl{constructor(e,s,r,n,i,o){this.globalStateService=e,this.i18nService=s,this.accessService=r,this.notificationService=n,this.analyticsService=i,this.adblockTest=o}async execute(e){e.reason==="install"&&(!await this.globalStateService.getCookiesUdid()&&await this.adblockTest.allowTestInitialisation(),await this.onInstall()),e.reason==="update"&&await this.onUpdate()}async onInstall(){await this.globalStateService.appBooted;const e=this.globalStateService.udid.type==="new"?"install":"reinstall";this.analyticsService.sendEvent({type:"google-analytics",name:"launch_first_time",data:{install_type:e}}),this.analyticsService.sendEvent({type:"amplitude",name:"launch_first_time",data:{install_type:e}}),this.analyticsService.sendEvent({type:"aws-kinesis",name:"install_completed",data:{event_properties__install_datetime:Date.now()}}),e==="reinstall"&&(this.analyticsService.sendEvent({type:"google-analytics",name:"reinstall_app_launch"}),this.analyticsService.sendEvent({type:"amplitude",name:"reinstall_app_launch"}),this.analyticsService.sendEvent({type:"aws-kinesis",name:"reinstall_app_launch"})),await this.accessService.proceedToWebsitePage({page:"install",params:{utm_campaign:"welcome"}})}async onUpdate(){await this.globalStateService.appBooted,this.analyticsService.sendEvent({type:"google-analytics",name:"update_app_version"}),this.analyticsService.sendEvent({type:"amplitude",name:"update_app_version"}),this.analyticsService.sendEvent({type:"aws-kinesis",name:"update_app_version"});const e=B.runtime.getManifest();await this.notificationService.notify({options:{title:this.i18nService.t("base:update-notification.title"),message:this.i18nService.t("base:update-notification.message",{tr_version:`v${e.version}`})},callback:"extension-updated"}),await this.accessService.proceedToWebsitePage({page:"update",params:{utm_campaign:"update_page"}})}}class ul{constructor(e,s,r,n){this.globalStateService=e,this.connectionService=s,this.analyticsService=r,this.connectionController=n}async execute(){await this.globalStateService.appBooted,this.connectionService.useAutoConnect&&this.globalStateService.hasInternetConnection?await this.connectionController.connect():await this.connectionController.disconnect({disconnectReason:"autoconnect_off",failedReason:"n/a"}),this.analyticsService.sendEvent({type:"aws-kinesis",name:"session_start"})}}const ll=new cl(G,ve,Ye,fe,Z,ts),dl=new ul(G,Pe,Z,It);B.runtime.onInstalled.addListener(t=>{ll.execute(t).catch(()=>{})});B.runtime.onStartup.addListener(()=>{dl.execute().catch(()=>{})});class hl{constructor(e,s){me(this,"authErrorMap",new Map);this.proxyService=e,this.analyticsService=s}async execute(e,s){const r=this.incrementAuthErrorCount(e.requestId);if(r>1)return r===2&&setTimeout(()=>{this.analyticsService.sendEvent({type:"google-analytics",name:"auth_error_screen_shown",data:{server_address:e.challenger.host,server_port:e.challenger.port}})},1e3),this.removeAuthErrorCount(e.requestId),s&&s({cancel:!0}),{cancel:!0};if(!(await this.proxyService.getServerConfigList()).flatMap(a=>a.addresses).includes(e.challenger.host))return s&&s({}),{};const o=await this.proxyService.getAuthCredentials();return o?(s&&s({authCredentials:o}),{authCredentials:o}):(setTimeout(()=>{this.analyticsService.sendEvent({type:"google-analytics",name:"auth_error_credentials_empty",data:{server_address:e.challenger.host,server_port:e.challenger.port}})},100),s&&s({}),{})}incrementAuthErrorCount(e){const r=(this.authErrorMap.get(e)??0)+1;return this.authErrorMap.set(e,r),r}removeAuthErrorCount(e){this.authErrorMap.delete(e)}}const pl=new hl(Qs,Z);B.webRequest.onAuthRequired.addListener((t,e)=>pl.execute(t,e),{urls:["<all_urls>"]},["asyncBlocking"]);class fl{constructor(e){this.connectionController=e}async execute(e){(e.levelOfControl==="not_controllable"||e.levelOfControl==="controlled_by_other_extensions")&&await this.connectionController.disconnect({disconnectReason:"controlled_by_other_extensions",failedReason:"n/a"})}}const ml=new fl(It);B.proxy.settings.onChange.addListener(t=>{ml.execute(t).catch(()=>{})});function gl(){const t=Dt.UAParser();if(!t.os.name)return"other";const e=t.os.name.toLocaleLowerCase();return e.includes("linux")?"linux":e.includes("mac")?"macos":e.includes("windows")?"windows":"other"}class yl{constructor(e,s,r,n,i,o){me(this,"actionMap",{"download-app":this.callbackDownloadApp.bind(this),"extension-updated":this.callbackExtensionUpdated.bind(this)});this.globalStateService=e,this.notificationService=s,this.appService=r,this.userService=n,this.accessService=i,this.analyticsService=o}async execute(e){var r,n;await this.globalStateService.appBooted;const s=this.notificationService.getCallbackSettings(e);s&&s.callback&&await((n=(r=this.actionMap)[s.callback])==null?void 0:n.call(r)),await this.notificationService.removeCallbackSettings(e)}async callbackDownloadApp(){const e=gl(),s=await this.appService.getDownloadLink(e);B.tabs.create({url:s}).catch(()=>{}),this.analyticsService.sendEvent({type:"google-analytics",name:"notify_popup_pc_download_click_free_download"}),this.analyticsService.sendEvent({type:"amplitude",name:"notify_popup_pc_download_click_free_download"})}async callbackExtensionUpdated(){this.userService.canUsePremiumDomain||await this.accessService.proceedToWebsitePage({page:"pricing",params:{utm_campaign:"update_notification"}}),this.analyticsService.sendEvent({type:"google-analytics",name:"update_popup_click"}),this.analyticsService.sendEvent({type:"amplitude",name:"update_popup_click"})}}const wl=new yl(G,fe,Se,xe,Ye,Z);B.notifications.onClicked.addListener(t=>{wl.execute(t).catch(()=>{})});class bl{constructor(e,s){this.globalStateService=e,this.eventService=s}async execute(){navigator.onLine!==this.globalStateService.hasInternetConnection&&(await this.globalStateService.setHasInternetConnection(navigator.onLine),this.eventService.dispatch({"internet-connection-changed":{online:navigator.onLine}}))}}const Sl=new bl(G,qr);var js;(js=navigator.connection)==null||js.addEventListener("change",()=>{Sl.execute().catch(()=>{})});(async()=>{Zr.init(),jr.init(),Kr.init(),al.init(),await G.boot(),await Z.boot(),await ts.boot(),await Qs.boot(),await Ye.boot(),await Ks.boot(),await Ws.boot(),await Se.boot(),await Pe.boot(),await Wr.boot(),await ve.boot(),await Gr.boot(),await fe.boot(),await xe.boot(),await Gs.boot(),await Vr.init(),await It.init(),await _t.boot(),await Y.boot(),await Wu.boot(),await Xu.boot(),G.globalboot()})().catch(t=>{var e,s;console.dir(t),typeof t=="object"&&t!==null&&"message"in t&&"stack"in t?Y.available?Y.send({type:"google-analytics",name:"background_boot_error",data:{error_message:String(t.message),error_stack:String(t.stack),runtime_last_error:((e=B.runtime.lastError)==null?void 0:e.message)??"not_set"}}).catch(console.dir):Y.boot().then(()=>{var r;return Y.send({type:"google-analytics",name:"background_boot_error",data:{error_message:String(t.message),error_stack:String(t.stack),runtime_last_error:((r=B.runtime.lastError)==null?void 0:r.message)??"not_set"}})}).catch(console.dir):Y.available?Y.send({type:"google-analytics",name:"background_boot_error",data:{error_message:String(t),error_stack:String(t),runtime_last_error:((s=B.runtime.lastError)==null?void 0:s.message)??"not_set"}}).catch(console.dir):Y.boot().then(()=>{var r;return Y.send({type:"google-analytics",name:"background_boot_error",data:{error_message:String(t),error_stack:String(t),runtime_last_error:((r=B.runtime.lastError)==null?void 0:r.message)??"not_set"}})}).catch(console.dir)});
